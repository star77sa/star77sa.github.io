<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.540">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="고경수">
<meta name="dcterms.date" content="2024-01-30">

<title>ksko - [통계전산] 통계</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../time-series.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ksko</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../about.html" aria-current="page"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/star77sa"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://ksko.notion.site"> <i class="bi bi-files" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Posts</li><li class="breadcrumb-item"><a href="../../posts/Statistics/1_probability_and_counting.html">Statistics</a></li><li class="breadcrumb-item"><a href="../../posts/Statistics/SC_1.html">[통계전산] 통계</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Posts</li><li class="breadcrumb-item"><a href="../../posts/Statistics/1_probability_and_counting.html">Statistics</a></li><li class="breadcrumb-item"><a href="../../posts/Statistics/SC_1.html">[통계전산] 통계</a></li></ol></nav>
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">[통계전산] 통계</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>고경수 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">January 30, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Posts</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">Linear Algebra</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Linear_Algebra/선형대수학.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">선형대수학</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Paper</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Paper/smartgrid1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">[논문 리뷰] Machine learning driven smart electric power system: Current trends and new perspectives(2020)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">Python</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Python/python_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">[Python] 자료형,Numpy,Pandas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Python/vis_matplotlib.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">[데이터시각화] 1. Matplotlib</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Python/vis_Plotly.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">[데이터시각화] 4. Plotly, 판다스 백엔드</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Python/vis_Seaborn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">[데이터시각화] 2. Seaborn</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Python/vis_tidydata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">[데이터시각화] 3. Pandas - <code>lambda df:</code>의 활용, <code>MultiIndex</code>의 이해, <code>tidydata</code>의 이해</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Python/visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">[데이터시각화] 0. 훌륭한 시각화</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Statistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Statistics/1_probability_and_counting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">[확률론] 1. Probability and counting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Statistics/SC_1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">[통계전산] 통계</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Statistics/SC_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">[통계전산] 선형대수학</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Statistics/데이터_분석.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">데이터 과학</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/Statistics/통계_101_X_데이터_분석.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">통계 101 X 데이터분석</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">잡동사니</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/잡동사니/2023-08-28-블로그.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2023.08.28 블로그 구축</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/잡동사니/NVIDIA초청강연.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2024 GIST-NVAITC Korea 강연 내용</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/잡동사니/논문_개념.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">논문 읽다가 모르겠거나 복습할 개념 정리</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/잡동사니/논문_영단어.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">논문 읽다가 모르는 영단어 정리</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/잡동사니/모델_성능평가지표_정리.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">성능 평가 지표(회귀모델, 분류모델)</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#통계-전산" id="toc-통계-전산" class="nav-link active" data-scroll-target="#통계-전산">통계 전산</a>
  <ul class="collapse">
  <li><a href="#로드맵" id="toc-로드맵" class="nav-link" data-scroll-target="#로드맵">로드맵</a></li>
  <li><a href="#베르누이" id="toc-베르누이" class="nav-link" data-scroll-target="#베르누이">베르누이</a></li>
  <li><a href="#이항분포" id="toc-이항분포" class="nav-link" data-scroll-target="#이항분포">이항분포</a></li>
  <li><a href="#포아송분포-x-sim-poilambda" id="toc-포아송분포-x-sim-poilambda" class="nav-link" data-scroll-target="#포아송분포-x-sim-poilambda">포아송분포 (<span class="math inline">\(X \sim Poi(\lambda)\)</span>)</a>
  <ul class="collapse">
  <li><a href="#포아송분포의-예시" id="toc-포아송분포의-예시" class="nav-link" data-scroll-target="#포아송분포의-예시">포아송분포의 예시</a></li>
  <li><a href="#how-to-generate-it" id="toc-how-to-generate-it" class="nav-link" data-scroll-target="#how-to-generate-it">How to generate it?</a></li>
  </ul></li>
  <li><a href="#지수분포-x-sim-explambda" id="toc-지수분포-x-sim-explambda" class="nav-link" data-scroll-target="#지수분포-x-sim-explambda">지수분포 <span class="math inline">\((X \sim Exp(\lambda))\)</span>)</a>
  <ul class="collapse">
  <li><a href="#지수분포의-요약" id="toc-지수분포의-요약" class="nav-link" data-scroll-target="#지수분포의-요약">지수분포의 요약</a></li>
  <li><a href="#how-to-generate-it-1" id="toc-how-to-generate-it-1" class="nav-link" data-scroll-target="#how-to-generate-it-1">How to generate it?</a></li>
  </ul></li>
  <li><a href="#inverse-cdf의-이론적-근거" id="toc-inverse-cdf의-이론적-근거" class="nav-link" data-scroll-target="#inverse-cdf의-이론적-근거">inverse cdf의 이론적 근거</a></li>
  <li><a href="#어느-사격수-이야기" id="toc-어느-사격수-이야기" class="nav-link" data-scroll-target="#어느-사격수-이야기">어느 사격수 이야기</a></li>
  <li><a href="#정규분포" id="toc-정규분포" class="nav-link" data-scroll-target="#정규분포">정규분포</a>
  <ul class="collapse">
  <li><a href="#정규분포-요약" id="toc-정규분포-요약" class="nav-link" data-scroll-target="#정규분포-요약">정규분포 요약</a></li>
  <li><a href="#how-to-generate-it-2" id="toc-how-to-generate-it-2" class="nav-link" data-scroll-target="#how-to-generate-it-2">how to generate it?</a></li>
  <li><a href="#가설검정" id="toc-가설검정" class="nav-link" data-scroll-target="#가설검정">가설검정</a></li>
  <li><a href="#note3-delta-method-생략" id="toc-note3-delta-method-생략" class="nav-link" data-scroll-target="#note3-delta-method-생략">note3: delta method (생략)</a></li>
  <li><a href="#위치모수와-척도모수" id="toc-위치모수와-척도모수" class="nav-link" data-scroll-target="#위치모수와-척도모수">위치모수와 척도모수</a></li>
  </ul></li>
  <li><a href="#카이제곱분포-xsim-chi2k" id="toc-카이제곱분포-xsim-chi2k" class="nav-link" data-scroll-target="#카이제곱분포-xsim-chi2k">카이제곱분포: <span class="math inline">\(X\sim \chi^2(k)\)</span></a>
  <ul class="collapse">
  <li><a href="#motive" id="toc-motive" class="nav-link" data-scroll-target="#motive">motive</a></li>
  <li><a href="#카이제곱-분포-요약" id="toc-카이제곱-분포-요약" class="nav-link" data-scroll-target="#카이제곱-분포-요약">카이제곱 분포 요약</a></li>
  <li><a href="#대의적-정의" id="toc-대의적-정의" class="nav-link" data-scroll-target="#대의적-정의">대의적 정의</a></li>
  <li><a href="#how-to-generate-it-3" id="toc-how-to-generate-it-3" class="nav-link" data-scroll-target="#how-to-generate-it-3">How to generate it?</a></li>
  <li><a href="#note-표본분산의-분포" id="toc-note-표본분산의-분포" class="nav-link" data-scroll-target="#note-표본분산의-분포">note: 표본분산의 분포</a></li>
  <li><a href="#카이제곱-분포의-합" id="toc-카이제곱-분포의-합" class="nav-link" data-scroll-target="#카이제곱-분포의-합">카이제곱 분포의 합</a></li>
  <li><a href="#히스토그램" id="toc-히스토그램" class="nav-link" data-scroll-target="#히스토그램">히스토그램</a></li>
  </ul></li>
  <li><a href="#감마분포-xsimgammaalpha-beta" id="toc-감마분포-xsimgammaalpha-beta" class="nav-link" data-scroll-target="#감마분포-xsimgammaalpha-beta">감마분포: <span class="math inline">\(X\sim\Gamma(\alpha, \beta)\)</span></a>
  <ul class="collapse">
  <li><a href="#감마분포-요약" id="toc-감마분포-요약" class="nav-link" data-scroll-target="#감마분포-요약">감마분포 요약</a></li>
  <li><a href="#대의적-정의alpha가-자연수일-경우" id="toc-대의적-정의alpha가-자연수일-경우" class="nav-link" data-scroll-target="#대의적-정의alpha가-자연수일-경우">대의적 정의(<span class="math inline">\(\alpha\)</span>가 자연수일 경우)</a></li>
  <li><a href="#how-to-generate-it-4" id="toc-how-to-generate-it-4" class="nav-link" data-scroll-target="#how-to-generate-it-4">how to generate it?</a></li>
  <li><a href="#감마분포와-카이제곱분포의-관계" id="toc-감마분포와-카이제곱분포의-관계" class="nav-link" data-scroll-target="#감마분포와-카이제곱분포의-관계">감마분포와 카이제곱분포의 관계</a></li>
  <li><a href="#척도모수" id="toc-척도모수" class="nav-link" data-scroll-target="#척도모수">척도모수</a></li>
  <li><a href="#감마분포의-합" id="toc-감마분포의-합" class="nav-link" data-scroll-target="#감마분포의-합">감마분포의 합</a></li>
  </ul></li>
  <li><a href="#지수분포의-다양한-표현" id="toc-지수분포의-다양한-표현" class="nav-link" data-scroll-target="#지수분포의-다양한-표현">지수분포의 다양한 표현</a></li>
  <li><a href="#참고-검정의-형식-논리" id="toc-참고-검정의-형식-논리" class="nav-link" data-scroll-target="#참고-검정의-형식-논리">참고: 검정의 형식 논리</a></li>
  <li><a href="#분포-간의-관계식-총정리" id="toc-분포-간의-관계식-총정리" class="nav-link" data-scroll-target="#분포-간의-관계식-총정리">분포 간의 관계식 총정리</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<nav id="TOC-body" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#통계-전산" id="toc-통계-전산">통계 전산</a>
  <ul>
  <li><a href="#로드맵" id="toc-로드맵">로드맵</a></li>
  <li><a href="#베르누이" id="toc-베르누이">베르누이</a></li>
  <li><a href="#이항분포" id="toc-이항분포">이항분포</a></li>
  <li><a href="#포아송분포-x-sim-poilambda" id="toc-포아송분포-x-sim-poilambda">포아송분포 (<span class="math inline">\(X \sim Poi(\lambda)\)</span>)</a>
  <ul>
  <li><a href="#포아송분포의-예시" id="toc-포아송분포의-예시">포아송분포의 예시</a></li>
  <li><a href="#how-to-generate-it" id="toc-how-to-generate-it">How to generate it?</a></li>
  </ul></li>
  <li><a href="#지수분포-x-sim-explambda" id="toc-지수분포-x-sim-explambda">지수분포 <span class="math inline">\((X \sim Exp(\lambda))\)</span>)</a>
  <ul>
  <li><a href="#지수분포의-요약" id="toc-지수분포의-요약">지수분포의 요약</a></li>
  <li><a href="#how-to-generate-it-1" id="toc-how-to-generate-it-1">How to generate it?</a></li>
  </ul></li>
  <li><a href="#inverse-cdf의-이론적-근거" id="toc-inverse-cdf의-이론적-근거">inverse cdf의 이론적 근거</a></li>
  <li><a href="#어느-사격수-이야기" id="toc-어느-사격수-이야기">어느 사격수 이야기</a></li>
  <li><a href="#정규분포" id="toc-정규분포">정규분포</a>
  <ul>
  <li><a href="#정규분포-요약" id="toc-정규분포-요약">정규분포 요약</a></li>
  <li><a href="#how-to-generate-it-2" id="toc-how-to-generate-it-2">how to generate it?</a></li>
  <li><a href="#가설검정" id="toc-가설검정">가설검정</a></li>
  <li><a href="#note3-delta-method-생략" id="toc-note3-delta-method-생략">note3: delta method (생략)</a></li>
  <li><a href="#위치모수와-척도모수" id="toc-위치모수와-척도모수">위치모수와 척도모수</a></li>
  </ul></li>
  <li><a href="#카이제곱분포-xsim-chi2k" id="toc-카이제곱분포-xsim-chi2k">카이제곱분포: <span class="math inline">\(X\sim \chi^2(k)\)</span></a>
  <ul>
  <li><a href="#motive" id="toc-motive">motive</a></li>
  <li><a href="#카이제곱-분포-요약" id="toc-카이제곱-분포-요약">카이제곱 분포 요약</a></li>
  <li><a href="#대의적-정의" id="toc-대의적-정의">대의적 정의</a></li>
  <li><a href="#how-to-generate-it-3" id="toc-how-to-generate-it-3">How to generate it?</a></li>
  <li><a href="#note-표본분산의-분포" id="toc-note-표본분산의-분포">note: 표본분산의 분포</a></li>
  <li><a href="#카이제곱-분포의-합" id="toc-카이제곱-분포의-합">카이제곱 분포의 합</a></li>
  <li><a href="#히스토그램" id="toc-히스토그램">히스토그램</a></li>
  </ul></li>
  <li><a href="#감마분포-xsimgammaalpha-beta" id="toc-감마분포-xsimgammaalpha-beta">감마분포: <span class="math inline">\(X\sim\Gamma(\alpha, \beta)\)</span></a>
  <ul>
  <li><a href="#감마분포-요약" id="toc-감마분포-요약">감마분포 요약</a></li>
  <li><a href="#대의적-정의alpha가-자연수일-경우" id="toc-대의적-정의alpha가-자연수일-경우">대의적 정의(<span class="math inline">\(\alpha\)</span>가 자연수일 경우)</a></li>
  <li><a href="#how-to-generate-it-4" id="toc-how-to-generate-it-4">how to generate it?</a></li>
  <li><a href="#감마분포와-카이제곱분포의-관계" id="toc-감마분포와-카이제곱분포의-관계">감마분포와 카이제곱분포의 관계</a></li>
  <li><a href="#척도모수" id="toc-척도모수">척도모수</a></li>
  <li><a href="#감마분포의-합" id="toc-감마분포의-합">감마분포의 합</a></li>
  </ul></li>
  <li><a href="#지수분포의-다양한-표현" id="toc-지수분포의-다양한-표현">지수분포의 다양한 표현</a></li>
  <li><a href="#참고-검정의-형식-논리" id="toc-참고-검정의-형식-논리">참고: 검정의 형식 논리</a></li>
  <li><a href="#분포-간의-관계식-총정리" id="toc-분포-간의-관계식-총정리">분포 간의 관계식 총정리</a></li>
  </ul></li>
  </ul>
</nav>
<p>최규빈 교수님 통계전산 수업 정리</p>
<p>수업에서는 Julia를 사용하지만 필요한 부분만 Python으로 바꾸어 작성하였다.</p>
<div id="cell-2" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="im">import</span> scipy.stats <span class="im">as</span> sps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="통계-전산" class="level1">
<h1>통계 전산</h1>
<section id="로드맵" class="level2">
<h2 class="anchored" data-anchor-id="로드맵">로드맵</h2>
<p><code>-</code> 통계</p>
<ul>
<li>일반통계학 개념의 백업</li>
<li>여러가지 분포리뷰, 어떠한 분포에서 샘플을 추출하는 방법</li>
<li>수렴</li>
<li>추정 및 검정</li>
<li>부트스트랩</li>
<li>선형회귀분석</li>
</ul>
<p><code>-</code> 선형대수학</p>
<ul>
<li>백터공간, rank</li>
<li>직교행렬, 사영행렬, 양정치행렬…</li>
<li>매트릭스를 해석하는 방식 (이미지, 데이터프레임, 변환)…</li>
<li>분해이론: 고유값분해, SVD</li>
<li>벡터나 매트릭스의 미분..</li>
</ul>
</section>
<section id="베르누이" class="level2">
<h2 class="anchored" data-anchor-id="베르누이">베르누이</h2>
</section>
<section id="이항분포" class="level2">
<h2 class="anchored" data-anchor-id="이항분포">이항분포</h2>
<p>1회당 성공확률이 p.&nbsp;n번을 시행해서 성공한 횟수가 X. 이를 N번 반복해서 나온 성공값들을 분포로 나타낸게 이항분포?</p>
</section>
<section id="포아송분포-x-sim-poilambda" class="level2">
<h2 class="anchored" data-anchor-id="포아송분포-x-sim-poilambda">포아송분포 (<span class="math inline">\(X \sim Poi(\lambda)\)</span>)</h2>
<p><code>-</code> 포아송분포의 요약</p>
<ul>
<li><p>X의의미: 발생횟수의 평균이 λ인 분포에서 실제 발생횟수를 X라고 한다.</p></li>
<li><p>X의범위: 발생안할수도 있으므로 X=0이 가능. 따라서 X=0,1,2,3,…</p></li>
<li><p>파라메터의 의미와 범위: λ = 평균적인 발생횟수; λ&gt;0.</p></li>
<li><p>pdf:</p></li>
<li><p>mgf:</p></li>
<li><p>E(X): λ</p></li>
<li><p>V(X): λ</p></li>
</ul>
<p>단위시간동안 어떤 이벤트가 발생했는데, 그 이벤트의 횟수가 포아송.</p>
<section id="포아송분포의-예시" class="level3">
<h3 class="anchored" data-anchor-id="포아송분포의-예시"><a href="https://www.statology.org/poisson-distribution-real-life-examples/#:~:text=Example%201%3A%20Calls%20per%20Hour,receives%2010%20calls%20per%20hour.">포아송분포의 예시</a></h3>
<ul>
<li><p>콜센타에 걸려오는 전화의 수, 1시간동안</p></li>
<li><p>레스토랑에 방문하는 손님의 수, 하루동안</p></li>
<li><p>웹사이트를 방문하는 사람의 수, 1시간동안</p></li>
<li><p>파산하는 사람의 수, 1달동안</p></li>
<li><p>네트워크의 끊김 수, 1주일동안</p></li>
</ul>
</section>
<section id="how-to-generate-it" class="level3">
<h3 class="anchored" data-anchor-id="how-to-generate-it">How to generate it?</h3>
<p>평균 3인 포아송분포에서 100개 샘플을 뽑는 방법</p>
<p>방법1)</p>
<div id="cell-17" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>pois <span class="op">=</span> np.random.poisson(<span class="dv">3</span>, <span class="dv">100</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a>pois</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>array([ 3,  4,  0,  7,  1,  3,  3,  5,  3,  2,  2,  6,  3,  5,  3,  2,  1,
        4,  4,  2,  8,  3,  3,  3,  2,  0,  3,  5,  2,  2,  2,  2,  5,  4,
        4,  7,  3,  5,  6,  2,  2,  1,  7,  3,  3,  1,  5,  5,  5,  6,  2,
        3,  3,  3,  2,  5,  2,  6,  2,  5,  4,  0,  3,  4,  2,  0,  3,  3,
        3,  4,  2,  3,  1,  1,  1,  5,  6,  2,  1,  3,  3,  3,  2,  7,  4,
        2,  2,  4,  3,  1,  5,  2, 10,  6,  2,  4,  0,  3,  2,  1])</code></pre>
</div>
</div>
<div id="cell-18" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>plt.hist(pois)<span class="op">;</span></span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># bar plot으로 나타내는 법</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co"># unique_values, count = np.unique(pois, return_counts=True)</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co"># plt.bar(unique_values, count)</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co"># ax = plt.gca()</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co"># ax.set_xlim([-1,11])</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co"># plt.title("pois")</span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co"># plt.xticks(np.arange(0,11,1)); # x축 1간격</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SC_1_files/figure-html/cell-4-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>방법2) 이항분포의 포아송근사를 이용</p>
<p>이론: 이항분포에서 (1) <span class="math inline">\(n→\infty\)</span> (2) <span class="math inline">\(p→0\)</span> (3) <span class="math inline">\(np=\lambda\)</span> 이면 이것은 평균이 <span class="math inline">\(\lambda\)</span> 인 포아송분포로 근사함.</p>
<p>평균이 <span class="math inline">\(\lambda\)</span> 인 포아송분포는 <span class="math inline">\(B(n,\frac{\lambda}{n})\)</span> 로 근사할 수 있다. 이때 <span class="math inline">\(n\)</span>이 커질수록 더 정확해짐.</p>
<div id="cell-21" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>N <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>λ <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>n <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>p <span class="op">=</span> λ<span class="op">/</span>n</span>
<span id="cb5-5"><a href="#cb5-5"></a>X <span class="op">=</span> np.random.binomial(n, p, N)</span>
<span id="cb5-6"><a href="#cb5-6"></a>Y <span class="op">=</span> np.random.poisson(λ, N)</span>
<span id="cb5-7"><a href="#cb5-7"></a></span>
<span id="cb5-8"><a href="#cb5-8"></a>fig, ((ax1), (ax2)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb5-9"><a href="#cb5-9"></a>ax1.hist(X)<span class="op">;</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>ax2.hist(Y)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SC_1_files/figure-html/cell-5-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>방법3) 균등분포 → 베르누이 → 이항분포 ≈ 포아송</p>
<ul>
<li>1분동안 맥도날드에 평균 3명이 온다고 생각</li>
<li>이건 사실 1초에 성공확률이 0.05인 베르누이 시행을 1번 시행하여 1분동안 총 60회 반복한 것으로 이해할 수 있음.</li>
<li>좀 더 세밀하게는 0.001초에 성공확률이 5.0e-5인 베르누이 시행을 1번 시행하여 1분동안 총 60000회 반복한 것으로도 이해할 수 있음. (무한반복 가능)</li>
<li>느낌: 하여튼 (1) “엄청 작은 시간”에 (2) “엄청 작은 확률”의 베르누이 시행이 (3) “엄청 많이 독립적으로 반복” 되는 느낌을 기억!! = 포아송 프로세스</li>
</ul>
<div id="cell-24" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>λ<span class="op">=</span><span class="dv">3</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>n<span class="op">=</span><span class="dv">60000</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>p<span class="op">=</span>λ<span class="op">/</span>n</span>
<span id="cb6-4"><a href="#cb6-4"></a>Δt <span class="op">=</span> (<span class="dv">60</span><span class="op">/</span>n) <span class="co"># 단위가 60초니까 60</span></span>
<span id="cb6-5"><a href="#cb6-5"></a></span>
<span id="cb6-6"><a href="#cb6-6"></a>N <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>X <span class="op">=</span> [<span class="bu">sum</span>(np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>,n)<span class="op">&lt;</span>p) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-25" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>fig, ((ax1), (ax2)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">8</span>))</span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a>ax1.hist(X)</span>
<span id="cb7-4"><a href="#cb7-4"></a>ax2.hist(np.random.poisson(λ, N))<span class="op">;</span></span>
<span id="cb7-5"><a href="#cb7-5"></a></span>
<span id="cb7-6"><a href="#cb7-6"></a>ax1.set_title(<span class="st">"Uniform → Bernoulli → Binomial ≈ Poisson"</span>)</span>
<span id="cb7-7"><a href="#cb7-7"></a>ax2.set_title(<span class="st">"Poisson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>Text(0.5, 1.0, 'Poisson')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SC_1_files/figure-html/cell-7-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>방법4) 균등분포 → inverse cdf method를 이용해서 생성할 수 있음.</p>
<blockquote class="blockquote">
<p><code>-</code> Inverse CDF Method?? 모든 확률 분포의 누적 분포 함수(cumulative distribution function, cdf)가 균등분포를 따른다는 성질을 이용한 방법</p>
</blockquote>
<blockquote class="blockquote">
<p>보통 난수를 일으킬 때에는 균등분포 난수 생성기를 이용하여 난수를 일으킨다. 그런데 만약 어떤 특정한 함수를 따르는 난수를 만들어내고 싶다면?? Inverse CDF Method를 사용하면 된다. 추후 수식 관련하여 자세히 다루기.</p>
</blockquote>
<ul>
<li><p>포아송 분포의 합은 다시 포아송분포가 된다.</p></li>
<li><p>이론: <span class="math inline">\(X \sim Poi(\lambda_1), Y \sim Poi(\lambda_2), X \bot Y \Rightarrow X+Y\sim Poi(\lambda_1+\lambda_2)\)</span></p></li>
<li><p>의미?: (1) 1분동안 맥도날드 매장에 들어오는 남자의 수는 평균이 5인 포아송 분포를 따름. (2) 1분동안 맥도날드 매장에 들어오는 여자의 수는 평균이 4.5인 포아송 분포를 따름. (3) 남자와 여자가 매장에 오는 사건은 독립 <span class="math inline">\(\rightarrow\)</span> 1분동안 맥도날드 매장에 오는 사람은 평균 9.5인 포아송 분포를 따른다는 의미</p></li>
</ul>
<div id="cell-29" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>N <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>X <span class="op">=</span> np.random.poisson(<span class="dv">5</span>, N)</span>
<span id="cb9-3"><a href="#cb9-3"></a>Y <span class="op">=</span> np.random.poisson(<span class="fl">4.5</span>, N)</span>
<span id="cb9-4"><a href="#cb9-4"></a></span>
<span id="cb9-5"><a href="#cb9-5"></a>p1 <span class="op">=</span> X<span class="op">+</span>Y</span>
<span id="cb9-6"><a href="#cb9-6"></a>p2 <span class="op">=</span> np.random.poisson(<span class="fl">9.5</span>, N)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-30" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>fig, ((ax1), (ax2)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>ax1.hist(p1)</span>
<span id="cb10-3"><a href="#cb10-3"></a>ax2.hist(p2)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SC_1_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="평균과-분산의-추정" class="level4">
<h4 class="anchored" data-anchor-id="평균과-분산의-추정">평균과 분산의 추정</h4>
<div id="cell-32" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>N <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>λ<span class="op">=</span><span class="dv">5</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>X<span class="op">=</span>np.random.poisson(λ, N)</span>
<span id="cb11-4"><a href="#cb11-4"></a></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="bu">print</span>(<span class="ss">f"평균: </span><span class="sc">{λ}</span><span class="ch">\</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="ss">      </span><span class="ch">\n</span><span class="ss">평균의 추정치: </span><span class="sc">{</span>np<span class="sc">.</span>mean(X)<span class="sc">}</span><span class="ch">\</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="ss">      </span><span class="ch">\n</span><span class="ss">분산: </span><span class="sc">{λ}</span><span class="ch">\</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="ss">      </span><span class="ch">\n</span><span class="ss">분산의 추정치: </span><span class="sc">{</span>np<span class="sc">.</span>var(X)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>평균: 5      
평균의 추정치: 4.914      
분산: 5      
분산의 추정치: 5.134604</code></pre>
</div>
</div>
<p><code>-</code> 생각해보니까 이론적으로 평균과 분산의 값이 같아야 한다는 걸 알고 있다. 그런데 왜 추정치가 달라야하나?? 둘 중 하나만 있으면 될 것 같다.</p>
<p>mean(X), var(X)로 <span class="math inline">\(\lambda\)</span>를 추정</p>
<div id="cell-35" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a>N <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>λ <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a>p1 <span class="op">=</span> [np.mean(np.random.poisson(λ, N)) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>)]</span>
<span id="cb13-5"><a href="#cb13-5"></a>p2 <span class="op">=</span> [np.var(np.random.poisson(λ, N)) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-36" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a>fig, ((ax1), (ax2)) <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a></span>
<span id="cb14-3"><a href="#cb14-3"></a>ax1.set_xlim([<span class="fl">4.8</span>, <span class="fl">5.2</span>])</span>
<span id="cb14-4"><a href="#cb14-4"></a>ax2.set_xlim([<span class="fl">4.8</span>, <span class="fl">5.2</span>])</span>
<span id="cb14-5"><a href="#cb14-5"></a></span>
<span id="cb14-6"><a href="#cb14-6"></a>ax1.set_ylim([<span class="dv">0</span>, <span class="dv">30</span>])</span>
<span id="cb14-7"><a href="#cb14-7"></a>ax2.set_ylim([<span class="dv">0</span>, <span class="dv">30</span>])</span>
<span id="cb14-8"><a href="#cb14-8"></a></span>
<span id="cb14-9"><a href="#cb14-9"></a>ax1.hist(p1)</span>
<span id="cb14-10"><a href="#cb14-10"></a>ax2.hist(p2)</span>
<span id="cb14-11"><a href="#cb14-11"></a></span>
<span id="cb14-12"><a href="#cb14-12"></a>ax1.set_title(<span class="st">"mean"</span>)</span>
<span id="cb14-13"><a href="#cb14-13"></a>ax2.set_title(<span class="st">"var"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SC_1_files/figure-html/cell-12-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>히스토그램을 그려보니까 누가봐도 mean(X)로 λ를 추정하는 것이 var(X)로 λ를 추정하는 것보다 좋아보인다.</p></li>
<li><p>그냥 평균을 추정한다음 이 값을 평균과 분산이라고 주장하면 안되나? <span class="math inline">\(\Rightarrow\)</span> 된다!! 이게 바로 MLE</p></li>
</ul>
</section>
</section>
</section>
<section id="지수분포-x-sim-explambda" class="level2">
<h2 class="anchored" data-anchor-id="지수분포-x-sim-explambda">지수분포 <span class="math inline">\((X \sim Exp(\lambda))\)</span>)</h2>
<section id="지수분포의-요약" class="level3">
<h3 class="anchored" data-anchor-id="지수분포의-요약">지수분포의 요약</h3>
<ul>
<li>X의 의미: 시간 1에 평균적으로 <span class="math inline">\(\lambda\)</span>번 발생하는 사건이 있을 때 첫 번째 이벤트가 발생할 때까지 걸리는 시간.</li>
<li>X의 범위: 시간은 양수이므로 X <span class="math inline">\(\geq\)</span> 0</li>
<li>파라메터의 의미: (1)<span class="math inline">\(\lambda\)</span> = 시간1에 평균적으로 발생하는 이벤트의 수 (2) 1/<span class="math inline">\(\lambda\)</span> = 한번의 이벤트가 발생할 때까지 평균적으로 걸리는 시간</li>
<li>파라메터의 범위: <span class="math inline">\(\lambda\)</span>&gt;0</li>
<li>pdf: <span class="math inline">\(f(x) = \lambda e^{- \lambda x}\)</span></li>
<li>mgf:</li>
<li>cdf: <span class="math inline">\(F(x) = 1-e^{-\lambda x}\)</span></li>
<li>E(X) = <span class="math inline">\(\frac{1}{\lambda}\)</span></li>
<li>V(X) = <span class="math inline">\(\frac{1}{\lambda ^2}\)</span></li>
</ul>
</section>
<section id="how-to-generate-it-1" class="level3">
<h3 class="anchored" data-anchor-id="how-to-generate-it-1">How to generate it?</h3>
<section id="평균이-10인-지수분포에서-10000개의-샘플을-뽑는-방법" class="level4">
<h4 class="anchored" data-anchor-id="평균이-10인-지수분포에서-10000개의-샘플을-뽑는-방법">평균이 10인 지수분포에서 10000개의 샘플을 뽑는 방법</h4>
<p>방법1: 모듈 / 방법2: 포아송 프로세스 / 방법3: inverse cdf method</p>
<p>(방법1)</p>
<div id="cell-44" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a>np.random.exponential(<span class="dv">10</span>, <span class="dv">10000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>array([ 2.81250688,  3.51950826,  9.34507485, ...,  1.21136792,
       15.43126406, 15.10395178])</code></pre>
</div>
</div>
<p>(방법2) 포아송 <span class="math inline">\(\rightarrow\)</span> 지수분포 (X), 포아송프로세스 <span class="math inline">\(\rightarrow\)</span> 지수분포 (O)</p>
<ul>
<li>맥도날드에 시간 1당 0.1명씩 평균적으로 방문한다. 1명 방문하는데에는 평균적으로 시간이 10이 걸린다고 볼 수 있음.</li>
<li>따라서 언뜻 생각하면 포아송과 지수분포는 역의 관계라서 포아송 분포를 만들고 역수를 취하면 지수분포를 쉽게 만들 수 있을 것 같다.</li>
</ul>
<div id="cell-47" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a>np.random.poisson(<span class="fl">0.1</span>, <span class="dv">10000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>array([0, 0, 0, ..., 0, 0, 1])</code></pre>
</div>
</div>
<ul>
<li>0이 나온다?</li>
<li>생각해보니 포아송은 정수이다. 0이 없다고 쳐도 역수를 취하면 나올 수 있는 값은 1, 1/2, 1/3, 1/4, … 따위임 지수 분포는 <span class="math inline">\(\frac{1}{0.5}, \frac{1}{1.5}\)</span> 등의 값도 가능해야하는데 포아송은 정수이므로 이러한 역수가 불가능함 (애초에 틀린 접근)</li>
<li>아이디어: 극한의 베르누이로 포아송을 만들 때, 몇 번 성공했는지 관심을 가지고 카운팅 했음. <span class="math inline">\(\Rightarrow\)</span> 조금 응용해서 첫 성공까지 몇 번의 시도를 해야하는지 카운팅을 한다고 생각하면 시간 계산이 가능할 것 같다.</li>
<li>결국 “포아송분포 <span class="math inline">\(\rightarrow\)</span> 지수분포”로 추출하는 것이 아니라 “포아송프로세스 <span class="math inline">\(\rightarrow\)</span> 지수분포”와 같은 방식으로 추출해야 한다.</li>
</ul>
<div id="cell-49" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># 성공할때까지 시도하는 함수: 성공확률 → 1회 성공까지 시도한 횟수 (기하분포를 뽑는 함수!!)</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="kw">def</span> try_until_you_succeed(p):</span>
<span id="cb19-3"><a href="#cb19-3"></a>    n_of_try <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>    u <span class="op">=</span> <span class="dv">0</span> <span class="co"># uniform</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>    <span class="cf">while</span> u <span class="op">&lt;</span> (<span class="dv">1</span><span class="op">-</span>p): <span class="co"># 실패했다면 / p=0이면 무한 반복</span></span>
<span id="cb19-6"><a href="#cb19-6"></a>        u <span class="op">=</span> np.random.uniform(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb19-7"><a href="#cb19-7"></a>        n_of_try <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb19-8"><a href="#cb19-8"></a>    <span class="cf">return</span> n_of_try</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-50" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a>plt.hist([try_until_you_succeed(<span class="fl">0.1</span>) <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10000</span>)], bins<span class="op">=</span><span class="dv">25</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SC_1_files/figure-html/cell-16-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-51" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a>N <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>λ <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>n <span class="op">=</span> <span class="dv">1000</span> <span class="co"># n-&gt;무한대. 10000이면 20분 넘게 걸려서 1000으로 줄임.</span></span>
<span id="cb21-4"><a href="#cb21-4"></a>p <span class="op">=</span> λ<span class="op">/</span>n</span>
<span id="cb21-5"><a href="#cb21-5"></a>Δt <span class="op">=</span> (<span class="dv">1</span><span class="op">/</span>n) <span class="co"># 단위가 시간 1이니까 </span></span>
<span id="cb21-6"><a href="#cb21-6"></a>X <span class="op">=</span> np.array([try_until_you_succeed(p) <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(N)]) <span class="op">*</span> Δt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-52" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a>fig, ((ax1), (ax2)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">1</span>, figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb22-2"><a href="#cb22-2"></a></span>
<span id="cb22-3"><a href="#cb22-3"></a>ax1.hist(X)</span>
<span id="cb22-4"><a href="#cb22-4"></a>ax2.hist(np.random.exponential(<span class="dv">10</span>, N))</span>
<span id="cb22-5"><a href="#cb22-5"></a></span>
<span id="cb22-6"><a href="#cb22-6"></a>ax1.set_title(<span class="st">"poisson process → exponential"</span>)</span>
<span id="cb22-7"><a href="#cb22-7"></a>ax2.set_title(<span class="st">"exponential"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SC_1_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>불평: 샘플하나뽑는데 시간이 오래걸림. (정확도를 올릴수록 더 오래걸림)</li>
</ul>
<p>(방법3) inverse cdf method - 이론적인 pdf를 알고 있다는 전제가 필요 - 자세하게 살펴보자</p>
</section>
<section id="inverse-cdf-method를-활용하여-지수분포에서-샘플-추출" class="level4">
<h4 class="anchored" data-anchor-id="inverse-cdf-method를-활용하여-지수분포에서-샘플-추출">Inverse cdf method를 활용하여 지수분포에서 샘플 추출</h4>
<ul>
<li><p>아래와 같은 2개의 지수분포의 pdf를 고려하자. (평균이 1인 지수분포와 평균이 5인 지수분포) <span class="math display">\[f(x)=e^{-x}\]</span> <span class="math display">\[g(x)=\frac{1}{5}e^{-\frac{1}{5}x}\]</span></p></li>
<li><p>각각의 pdf를 그려보면 아래와 같다.</p></li>
</ul>
<div id="cell-55" class="cell" data-execution_count="133">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">100</span>)</span>
<span id="cb23-2"><a href="#cb23-2"></a></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="kw">def</span> fx(x):</span>
<span id="cb23-4"><a href="#cb23-4"></a>    <span class="cf">return</span> np.exp(<span class="op">-</span><span class="dv">1</span><span class="op">*</span>x)</span>
<span id="cb23-5"><a href="#cb23-5"></a></span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="kw">def</span> gx(x):</span>
<span id="cb23-7"><a href="#cb23-7"></a>    <span class="cf">return</span> <span class="dv">1</span><span class="op">/</span><span class="dv">5</span> <span class="op">*</span> np.exp(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">5</span><span class="op">*</span>x)</span>
<span id="cb23-8"><a href="#cb23-8"></a></span>
<span id="cb23-9"><a href="#cb23-9"></a>fig, ((ax1), (ax2)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">8</span>))</span>
<span id="cb23-10"><a href="#cb23-10"></a></span>
<span id="cb23-11"><a href="#cb23-11"></a>ax1.plot(x, fx(x))</span>
<span id="cb23-12"><a href="#cb23-12"></a>ax2.plot(x, gx(x))</span>
<span id="cb23-13"><a href="#cb23-13"></a></span>
<span id="cb23-14"><a href="#cb23-14"></a>ax1.set_title(<span class="st">"$f(x)=e^{-x}$"</span>)</span>
<span id="cb23-15"><a href="#cb23-15"></a></span>
<span id="cb23-16"><a href="#cb23-16"></a>ax2.set_title(<span class="st">"$g(x)=(1/5)e^{(-1/5)x}$"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SC_1_files/figure-html/cell-19-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>아래 그래프에서 뽑은 값이 더 클 것 같다. (위 그래프는 왼쪽에 몰려있음)</p></li>
<li><p>이번에는 각각의 cdf를 그려보자. <span class="math display">\[F(x) = \int^x_0f(\tau)d\tau = \int^x_0 e^{-\tau}d\tau=[-e^{-\tau}]^x_0 = 1-e^{-x}\]</span> <span class="math display">\[G(x) = \int^x_0g(\tau)d\tau = \int^x_0 \frac{1}{5}e^{-\tau/5}d\tau=[-e^{-\tau/5}]^x_0 = 1-e^{-x/5}\]</span></p></li>
</ul>
<div id="cell-58" class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">20</span>, <span class="dv">100</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="kw">def</span> Fx(x):</span>
<span id="cb24-4"><a href="#cb24-4"></a>    <span class="cf">return</span> <span class="dv">1</span><span class="op">-</span>np.exp(<span class="op">-</span><span class="dv">1</span><span class="op">*</span>x)</span>
<span id="cb24-5"><a href="#cb24-5"></a></span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="kw">def</span> Gx(x):</span>
<span id="cb24-7"><a href="#cb24-7"></a>    <span class="cf">return</span> <span class="dv">1</span><span class="op">-</span>np.exp(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">5</span><span class="op">*</span>x)</span>
<span id="cb24-8"><a href="#cb24-8"></a></span>
<span id="cb24-9"><a href="#cb24-9"></a>fig, ((ax1), (ax2)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">8</span>))</span>
<span id="cb24-10"><a href="#cb24-10"></a></span>
<span id="cb24-11"><a href="#cb24-11"></a>ax1.plot(x, Fx(x))</span>
<span id="cb24-12"><a href="#cb24-12"></a>ax2.plot(x, Gx(x))</span>
<span id="cb24-13"><a href="#cb24-13"></a></span>
<span id="cb24-14"><a href="#cb24-14"></a>ax1.set_xticks(np.arange(<span class="dv">0</span>,<span class="dv">21</span>,<span class="dv">1</span>))</span>
<span id="cb24-15"><a href="#cb24-15"></a>ax2.set_xticks(np.arange(<span class="dv">0</span>,<span class="dv">21</span>,<span class="dv">1</span>))</span>
<span id="cb24-16"><a href="#cb24-16"></a></span>
<span id="cb24-17"><a href="#cb24-17"></a>ax1.set_title(<span class="st">"$F(x)=1-e^{-x}$"</span>)</span>
<span id="cb24-18"><a href="#cb24-18"></a>ax2.set_title(<span class="st">"$G(x)=1-e^{(-1/5)x}$"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SC_1_files/figure-html/cell-20-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-59" class="cell" data-execution_count="130">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="dv">1</span><span class="sc">,</span> Fx(<span class="dv">1</span>)<span class="sc">}</span><span class="ss"> 위 그래프에서 약 </span><span class="sc">{</span><span class="bu">round</span>(Fx(<span class="dv">1</span>),<span class="dv">2</span>)<span class="op">*</span><span class="dv">100</span><span class="sc">}</span><span class="ss">%는 1보다 작다."</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="dv">5</span><span class="sc">,</span> Fx(<span class="dv">5</span>)<span class="sc">}</span><span class="ss"> 위 그래프에서 약 </span><span class="sc">{</span><span class="bu">round</span>(Fx(<span class="dv">5</span>),<span class="dv">2</span>)<span class="op">*</span><span class="dv">100</span><span class="sc">}</span><span class="ss">%는 5보다 작다."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(1, 0.6321205588285577) 위 그래프에서 약 63.0%는 1보다 작다.
(5, 0.9932620530009145) 위 그래프에서 약 99.0%는 5보다 작다.</code></pre>
</div>
</div>
<div id="cell-60" class="cell" data-execution_count="131">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="dv">1</span><span class="sc">,</span> Gx(<span class="dv">1</span>)<span class="sc">}</span><span class="ss"> 아래 그래프에서 약 </span><span class="sc">{</span><span class="bu">round</span>(Gx(<span class="dv">1</span>),<span class="dv">2</span>)<span class="op">*</span><span class="dv">100</span><span class="sc">}</span><span class="ss">%는 1보다 작다."</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="dv">5</span><span class="sc">,</span> Gx(<span class="dv">5</span>)<span class="sc">}</span><span class="ss"> 아래 그래프에서 약 </span><span class="sc">{</span><span class="bu">round</span>(Gx(<span class="dv">5</span>),<span class="dv">2</span>)<span class="op">*</span><span class="dv">100</span><span class="sc">}</span><span class="ss">%는 5보다 작다."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(1, 0.18126924692201818) 아래 그래프에서 약 18.0%는 1보다 작다.
(5, 0.6321205588285577) 아래 그래프에서 약 63.0%는 5보다 작다.</code></pre>
</div>
</div>
<p><code>-</code> cdf 해석 - 위(평균이 1인 지수분포) = 5정도면 거의 cdf의 값이 1에 가까워짐. - 아래(평균이 5인 지수분포) = 5정도면 값이 0.63정도임 <span class="math inline">\(\rightarrow\)</span> 100번 뽑으면 5보다 작은게 63개 정도…</p>
<p><code>-</code> cdf의 y축에서 랜덤변수를 발생시킨다음 <span class="math inline">\(\rightarrow \downarrow\)</span>와 같이 이동하여 <span class="math inline">\(x\)</span>축에 내린다고 생각해보자. (역함수를 구하는 것) - 위: 대부분 5이하에 떨어짐 - 아래: 약 63% 정도만 5이하에 떨어짐.</p>
<div id="cell-62" class="cell" data-execution_count="150">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">def</span> Finv(x): <span class="co"># 평균이 1인 지수분포 cdf의 역함수</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>    <span class="cf">return</span> <span class="op">-</span>np.log(<span class="dv">1</span><span class="op">-</span>x)</span>
<span id="cb29-3"><a href="#cb29-3"></a></span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="kw">def</span> Ginv(x): <span class="co"># 평균이 5인 지수분포 cdf의 역함수</span></span>
<span id="cb29-5"><a href="#cb29-5"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">5</span><span class="op">*</span>np.log(<span class="dv">1</span><span class="op">-</span>x)</span>
<span id="cb29-6"><a href="#cb29-6"></a></span>
<span id="cb29-7"><a href="#cb29-7"></a>u <span class="op">=</span> np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">5</span>)</span>
<span id="cb29-8"><a href="#cb29-8"></a></span>
<span id="cb29-9"><a href="#cb29-9"></a>fig, ((ax1), (ax2)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">8</span>))</span>
<span id="cb29-10"><a href="#cb29-10"></a></span>
<span id="cb29-11"><a href="#cb29-11"></a>ax1.plot(x, Fx(x))</span>
<span id="cb29-12"><a href="#cb29-12"></a>ax1.plot([<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>], u, <span class="st">'or'</span>, )</span>
<span id="cb29-13"><a href="#cb29-13"></a>ax1.plot(Finv(u), [<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>], <span class="st">'ob'</span>)</span>
<span id="cb29-14"><a href="#cb29-14"></a></span>
<span id="cb29-15"><a href="#cb29-15"></a></span>
<span id="cb29-16"><a href="#cb29-16"></a>ax2.plot(x, Gx(x))</span>
<span id="cb29-17"><a href="#cb29-17"></a>ax2.plot([<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>], u, <span class="st">'or'</span>, )</span>
<span id="cb29-18"><a href="#cb29-18"></a>ax2.plot(Ginv(u), [<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>], <span class="st">'ob'</span>)</span>
<span id="cb29-19"><a href="#cb29-19"></a></span>
<span id="cb29-20"><a href="#cb29-20"></a>ax1.set_xticks(np.arange(<span class="dv">0</span>,<span class="dv">21</span>,<span class="dv">1</span>))<span class="op">;</span></span>
<span id="cb29-21"><a href="#cb29-21"></a>ax2.set_xticks(np.arange(<span class="dv">0</span>,<span class="dv">21</span>,<span class="dv">1</span>))<span class="op">;</span></span>
<span id="cb29-22"><a href="#cb29-22"></a></span>
<span id="cb29-23"><a href="#cb29-23"></a>ax1.set_title(<span class="st">"Mean = 1"</span>)</span>
<span id="cb29-24"><a href="#cb29-24"></a>ax2.set_title(<span class="st">"Mean = 5"</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SC_1_files/figure-html/cell-23-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>빨간색: 균등분포</li>
<li>파란색: 이게 지수분포 같은데?</li>
</ul>
<section id="inverse-cdf-method-알고리즘-정리" class="level5">
<h5 class="anchored" data-anchor-id="inverse-cdf-method-알고리즘-정리">inverse cdf method 알고리즘 정리</h5>
<p><span class="math inline">\(X_1, X_2, \dots, X_n \overset{iid}{\sim} F\)</span>를 생성하고 싶다면?</p>
<ol type="1">
<li>균등분포에서 <span class="math inline">\(n\)</span>개의 난수를 독립적으로 생성한다. 이를 <span class="math inline">\(U_1, U_2, \dots, U_n\)</span>이라고 하자.</li>
<li><span class="math inline">\(X_1 = F^{-1}(U_1), X_2 = F^{-1}(U_2),\dots,X_n = F^{-1}(U_n)\)</span> 이라고 놓는다.</li>
</ol>
<ul>
<li>예제1: inverse cdf를 이용하여 평균이 1인 지수분포 10000개를 생성하여 보자.</li>
</ul>
<p>(풀이)</p>
<div id="cell-65" class="cell" data-execution_count="161">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a>fig, ((ax1), (ax2)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">8</span>))</span>
<span id="cb30-2"><a href="#cb30-2"></a></span>
<span id="cb30-3"><a href="#cb30-3"></a>u <span class="op">=</span> np.random.uniform(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">10000</span>)</span>
<span id="cb30-4"><a href="#cb30-4"></a>ax1.hist(Finv(u))</span>
<span id="cb30-5"><a href="#cb30-5"></a></span>
<span id="cb30-6"><a href="#cb30-6"></a>ax2.hist(np.random.exponential(<span class="dv">1</span>, <span class="dv">10000</span>))</span>
<span id="cb30-7"><a href="#cb30-7"></a></span>
<span id="cb30-8"><a href="#cb30-8"></a>ax1.set_xticks(np.arange(<span class="dv">0</span>,<span class="dv">21</span>,<span class="dv">1</span>))<span class="op">;</span></span>
<span id="cb30-9"><a href="#cb30-9"></a>ax2.set_xticks(np.arange(<span class="dv">0</span>,<span class="dv">21</span>,<span class="dv">1</span>))<span class="op">;</span></span>
<span id="cb30-10"><a href="#cb30-10"></a></span>
<span id="cb30-11"><a href="#cb30-11"></a>ax1.set_title(<span class="st">"inverse cdf"</span>)</span>
<span id="cb30-12"><a href="#cb30-12"></a>ax2.set_title(<span class="st">"exponential"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="161">
<pre><code>Text(0.5, 1.0, 'exponential')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SC_1_files/figure-html/cell-24-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="지수분포의-무기억성" class="level4">
<h4 class="anchored" data-anchor-id="지수분포의-무기억성">지수분포의 무기억성</h4>
<blockquote class="blockquote">
<p><code>-</code> 수리통계학 책</p>
</blockquote>
<blockquote class="blockquote">
<ul>
<li>지수분포 평균은 <span class="math inline">\(\frac{1}{\lambda}\)</span> 인데 수식에서 사용하는 값은 <span class="math inline">\(\lambda\)</span>임 계산할 때 주의</li>
</ul>
</blockquote>
<blockquote class="blockquote">
<ul>
<li>이산형 확률분포에서 기하확률변수가 무기억 성질을 갖는 것처럼 연속형 확률변수 중에서는 지수확률변수가 동일한 성질을 지닌다.</li>
</ul>
</blockquote>
<blockquote class="blockquote">
<ul>
<li><span class="math inline">\(X \sim EXP(\frac{1}{\lambda})\)</span> 이면, 양의 실수 <span class="math inline">\(a\)</span>와 <span class="math inline">\(t\)</span>에 대해서,</li>
</ul>
</blockquote>
<blockquote class="blockquote">
<p><span class="math display">\[P(X&gt;a+t|X&gt;a) = P(X&gt;t)\]</span></p>
</blockquote>
<blockquote class="blockquote">
<p>가 성립한다.</p>
</blockquote>
<blockquote class="blockquote">
<ul>
<li>위 정리의 의미: 가령, 확률변수 <span class="math inline">\(X\)</span>가 어떤 기계부품의 수명이라고 하면, <span class="math inline">\(P(X&gt;a+t|X&gt;a)\)</span>는 시점 <span class="math inline">\(a\)</span>에서 기계부품의 고장이 없을 때, 최소한 시간 <span class="math inline">\(t\)</span>만큼 더 고장이 없을 사건에 대한 확률을 뜻한다. 따라서 정리의 무기억 성질은 변수 <span class="math inline">\(X\)</span>가 시점 <span class="math inline">\(a\)</span>에서 그동안 기계부품의 고장이 없었다는 조건을 ’기억’하지 않고, 앞으로 시간 <span class="math inline">\(t\)</span>만큼 더 고장이 없을 것만 고려한다는 것을 뜻하는 것으로, <span class="math inline">\(a\)</span>시간만큼 일한 기계부품이 앞으로 <span class="math inline">\(t\)</span>시간만큼 더 작동하는 확률이나 새 기계부품이 앞으로 <span class="math inline">\(t\)</span>시간 만큼 더 작동하는 확률이나 같다는 것이다.</li>
</ul>
</blockquote>
<ul>
<li><p>예시 <span class="math display">\[P(X&gt;1) = P(X&gt;10|X&gt;9)\]</span></p></li>
<li><p>좌변: 시간을 1 기다려서 이벤트가 발생 안 할 확률</p></li>
<li><p>우변: 시간을 9 기다렸는데 이벤트가 발생 안했음 <span class="math inline">\(\rightarrow\)</span> 시간을 10기다려서 이벤트가 발생 안 할 확률</p></li>
<li><p>예를들어서 <span class="math inline">\(\lambda = 0.1\)</span>이라면 한번 이벤트 발생하는데 평균 시간 10이 걸린다는 의미.</p>
<ol type="1">
<li>좌변은 이제 시간 1 기다림. (2) 우변은 시간 9 기다림. 곧 “약속된” 시간 10이 완성됨 <span class="math inline">\(\Rightarrow\)</span> 우변이 더 확률이 크지 않을까? <span class="math inline">\(\Rightarrow\)</span> 아니라는 것!!</li>
</ol></li>
<li><p>이해: 지수분포의 근본? 포아송 프로세스</p>
<ul>
<li>엄청 짧은 시간</li>
<li>엄청 작은 확률</li>
<li>엄청 많은 베르누이 시행이 “독립적”으로 수행 <span class="math inline">\(\rightarrow\)</span> 지금까지 실패했다고 해서 이후에 성공확률이 높아지는건 아님.</li>
<li>우변: 이미 시간 9 동안 무수히 많은 독립적인 베르누이 시행을 놓친상태임. 그 이후의 시행은 모두 독립이므로 좌변의 확률보다 더 크다고 볼 수 없음.</li>
</ul></li>
</ul>
<p><code>-</code> 무기억성 = 과거는 중요하지 않음! <span class="math inline">\(\Rightarrow P(X&gt;1) = P(X&gt;2|X&gt;1) = P(X&gt;3|X&gt;2) = \dots\)</span></p>
</section>
<section id="몬테카를로-적분" class="level4">
<h4 class="anchored">몬테카를로 적분</h4>
<section id="예제1-아래를-계산하라" class="level5">
<h5 class="anchored" data-anchor-id="예제1-아래를-계산하라">예제1: 아래를 계산하라</h5>
<p><span class="math display">\[\int^\infty_0 xe^{-x}dx = ?\]</span></p>
<p>(손풀이) <span class="math inline">\(\int^\infty_0xe^{-x}dx=??=1\)</span></p>
<p>(손풀이2) <span class="math inline">\(\int^\infty_0xe^{-x}dx= \int^\infty_0x\times e^{-x}dx\)</span> 은 <span class="math inline">\(\lambda=1\)</span>인 지수분포의 평균이다. 따라서 답은 1.</p>
<p>(컴퓨터를 이용한 풀이)</p>
<div id="cell-76" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a>np.mean(np.random.exponential(<span class="dv">1</span>, <span class="dv">10000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>1.0033097374284965</code></pre>
</div>
</div>
</section>
<section id="예제2-아래를-계산하라" class="level5">
<h5 class="anchored">예제2: 아래를 계산하라</h5>
<p><span class="math display">\[\int^\infty_0 x^2e^{-x}dx = ?\]</span></p>
<p>(컴퓨터를 이용한 풀이)</p>
<div id="cell-79" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a>np.mean((<span class="kw">lambda</span> x: x<span class="op">**</span><span class="dv">2</span>)(np.random.exponential(<span class="dv">1</span>,<span class="dv">10000</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>2.0209238762363655</code></pre>
</div>
</div>
<ul>
<li><p>분산 = 제곱의평균 - 평균의제곱 이므로</p>
<p><code>제곱의평균</code> = 분산 + 평균의제곱 = <span class="math inline">\(1+1^2\)</span></p></li>
</ul>
<blockquote class="blockquote">
<h3 id="생략" class="anchored" data-anchor-id="예제2-아래를-계산하라">생략</h3>
<h5 id="예제3" class="anchored">예제3: ~</h5>
<h4 id="박스뮬러-변환" class="anchored">박스뮬러 변환</h4>
<h4 id="lambda에-따른-포아송과-지수분포의-히스토그램-변화-관찰" class="anchored"><span class="math inline">\(\lambda\)</span>에 따른 포아송과 지수분포의 히스토그램 변화 관찰</h4>
</blockquote>
</section>
</section>
</section>
</section>
<section id="inverse-cdf의-이론적-근거" class="level2">
<h2 class="anchored" data-anchor-id="inverse-cdf의-이론적-근거">inverse cdf의 이론적 근거</h2>
</section>
<section id="어느-사격수-이야기" class="level2">
<h2 class="anchored" data-anchor-id="어느-사격수-이야기">어느 사격수 이야기</h2>
<p><span class="math display">\[X_1, X_2 \overset{iid}{\sim} N(0,1) \Rightarrow X_1^{2}+X_2^{2}\sim\chi^2(2)\]</span></p>
<p><span class="math display">\[X_1, X_2 \overset{iid}{\sim} N(0,1) \Rightarrow \frac{1}{2}(X_1^{2}+X_2^{2})\sim Exp(1)\]</span></p>
<ul>
<li>점추정(모수를 모르는 상태에서 예측하는 것), 구간추정(정확한 점을 예측하기는 어려우니) + 95% 신뢰구간</li>
<li>정규분포, 카이제곱, 지수, 감마 분포의 관계</li>
</ul>
</section>
<section id="정규분포" class="level2">
<h2 class="anchored" data-anchor-id="정규분포">정규분포</h2>
<section id="정규분포-요약" class="level3">
<h3 class="anchored" data-anchor-id="정규분포-요약">정규분포 요약</h3>
<ul>
<li>X의 의미:</li>
<li>X의 범위: <span class="math inline">\(x\in \mathbb{R}\)</span></li>
<li>파라메터의 의미와 범위: <span class="math inline">\(\mu\)</span> 평균, <span class="math inline">\(\sigma^2\)</span>=분산, <span class="math inline">\(\mu \in \mathbb{R}, \sigma^2&gt;0\)</span></li>
<li>pdf: <span class="math inline">\(f(x)=\frac{1}{\sqrt{2\pi\sigma^2}}e^{-\frac{1}{2}(\frac{x-\mu}{\sigma})^2}\)</span></li>
<li>mgf:</li>
<li>E(X): <span class="math inline">\(\mu\)</span></li>
<li>V(X): <span class="math inline">\(\sigma^2\)</span></li>
</ul>
</section>
<section id="how-to-generate-it-2" class="level3">
<h3 class="anchored" data-anchor-id="how-to-generate-it-2">how to generate it?</h3>
<p>방법3: (지수분포, 유니폼) → 서로 독립인 2개의 정규분포</p>
<section id="note-1" class="level4">
<h4 class="anchored" data-anchor-id="note-1">note 1</h4>
<ul>
<li>이론: <span class="math inline">\(X_1, \dots, X_n \overset{iid}{\sim} N(\mu, \sigma^2) \Rightarrow \frac{\bar{X}-\mu}{\sigma/\sqrt{n}}\sim N(0,1)\)</span></li>
</ul>
<div id="cell-93" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a>N<span class="op">=</span><span class="dv">10000000</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>n<span class="op">=</span><span class="dv">25</span> </span>
<span id="cb36-3"><a href="#cb36-3"></a>σ<span class="op">=</span><span class="dv">5</span> </span>
<span id="cb36-4"><a href="#cb36-4"></a>μ<span class="op">=</span><span class="dv">7</span></span>
<span id="cb36-5"><a href="#cb36-5"></a></span>
<span id="cb36-6"><a href="#cb36-6"></a>y1 <span class="op">=</span> [np.mean(np.random.normal(μ,σ,n)) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N)]</span>
<span id="cb36-7"><a href="#cb36-7"></a>y2 <span class="op">=</span> np.random.normal(μ,σ<span class="op">/</span>np.sqrt(n),N)</span>
<span id="cb36-8"><a href="#cb36-8"></a></span>
<span id="cb36-9"><a href="#cb36-9"></a>plt.xticks(np.arange(<span class="dv">1</span>,<span class="dv">14</span>,<span class="dv">1</span>))</span>
<span id="cb36-10"><a href="#cb36-10"></a>plt.hist(y1, color<span class="op">=</span><span class="st">'blue'</span>, bins<span class="op">=</span><span class="dv">1000</span>, histtype<span class="op">=</span><span class="st">'step'</span>)</span>
<span id="cb36-11"><a href="#cb36-11"></a>plt.hist(y2, color<span class="op">=</span><span class="st">'red'</span>, alpha<span class="op">=</span><span class="fl">0.2</span>, bins<span class="op">=</span><span class="dv">1000</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SC_1_files/figure-html/cell-27-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>예제1: <span class="math inline">\(\bar{X}\)</span>는 분산이 100, 평균이 <span class="math inline">\(\mu\)</span>인 분포에서 추출한 크기가 25인 확률표본의 평균이다. 관찰된 표본의 평균이 <span class="math inline">\(\bar{x} = 67.53\)</span>일때 <span class="math inline">\(\mu\)</span>에 대한 95% 신뢰구간을 구하여라.</li>
</ul>
<p>(풀이1)</p>
<div id="cell-95" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a>c <span class="op">=</span> np.quantile([np.mean(np.random.normal(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">25</span>)) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1000000</span>)], <span class="fl">0.975</span>)</span>
<span id="cb37-2"><a href="#cb37-2"></a>c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>3.92342365350967</code></pre>
</div>
</div>
<ul>
<li>뒷면해석: <span class="math inline">\(X_1,\dots,X_{25} \overset{iid}{\sim} N(0,10) \Rightarrow P(-3.92\leq\bar{X}\leq 3.92) \approx 0.95\)</span> (평균을 0으로 가정한 상황)</li>
<li>뒷면해석의 일반화: <span class="math inline">\(X_1,\dots,X_{25} \overset{iid}{\sim} N(\mu,10) \Rightarrow P(\mu-3.92\leq\bar{X}\leq \mu+3.92) \approx 0.95\)</span></li>
<li>앞면느낌의 해석: <span class="math inline">\(X_1,\dots,X_{25} \overset{iid}{\sim} N(\mu,10) \Rightarrow P(\bar{X}-3.92\leq\mu\leq \bar{X}+3.92) \approx 0.95\)</span></li>
</ul>
<div id="cell-97" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1"></a>xbar <span class="op">=</span> <span class="fl">67.53</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>(xbar<span class="op">-</span>c, xbar<span class="op">+</span>c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>(63.60657634649033, 71.45342365350967)</code></pre>
</div>
</div>
<p>(풀이2)</p>
<div id="cell-99" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a>n <span class="op">=</span> <span class="dv">25</span></span>
<span id="cb41-2"><a href="#cb41-2"></a>σ <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb41-3"><a href="#cb41-3"></a>dist <span class="op">=</span> sps.norm(loc<span class="op">=</span><span class="dv">0</span>, scale<span class="op">=</span>σ<span class="op">/</span>np.sqrt(n))</span>
<span id="cb41-4"><a href="#cb41-4"></a>c <span class="op">=</span> dist.ppf(<span class="fl">0.975</span>)</span>
<span id="cb41-5"><a href="#cb41-5"></a>xbar <span class="op">=</span> <span class="fl">67.53</span></span>
<span id="cb41-6"><a href="#cb41-6"></a>(xbar<span class="op">-</span>c, xbar<span class="op">+</span>c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<pre><code>(63.610072030919895, 71.44992796908011)</code></pre>
</div>
</div>
</section>
<section id="note2-clt" class="level4">
<h4 class="anchored" data-anchor-id="note2-clt">note2 (CLT)</h4>
<ul>
<li><p>이론: (1) <span class="math inline">\(X_1,\dots,X_n\overset{iid}{\sim}F\)</span> and (2) <span class="math inline">\(V(X_1)&lt;\infty\Rightarrow\frac{\bar{X}-\mu}{\sigma/\sqrt{n}}\overset{d}{\rightarrow}Z, \ \ \ \ Z\sim N(0,1)\)</span></p></li>
<li><p>뒷부분은 <span class="math inline">\(\bar{X}\overset{d}{\rightarrow}Z', \ \ \ Z'\sim N(\mu, \frac{\sigma}{\sqrt{n}})\)</span>로 해석가능</p></li>
</ul>
<p><code>-</code> 확인</p>
<div id="cell-104" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a>p <span class="op">=</span> <span class="fl">0.9</span></span>
<span id="cb43-2"><a href="#cb43-2"></a>N <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb43-3"><a href="#cb43-3"></a>n <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb43-4"><a href="#cb43-4"></a>Xbar <span class="op">=</span> [np.mean(np.random.binomial(<span class="dv">1</span>,p,n)) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N)] <span class="co"># 베르누이</span></span>
<span id="cb43-5"><a href="#cb43-5"></a></span>
<span id="cb43-6"><a href="#cb43-6"></a>n<span class="op">=</span><span class="dv">500</span></span>
<span id="cb43-7"><a href="#cb43-7"></a>Ybar <span class="op">=</span> [np.mean(np.random.binomial(<span class="dv">1</span>,p,n)) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N)] <span class="co"># 베르누이</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-105" class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1"></a>plt.hist(Xbar, bins <span class="op">=</span> <span class="dv">50</span>, label<span class="op">=</span><span class="st">'Xbar'</span>)</span>
<span id="cb44-2"><a href="#cb44-2"></a>plt.hist(Ybar, bins <span class="op">=</span> <span class="dv">50</span>, label<span class="op">=</span><span class="st">'Ybar'</span>)<span class="op">;</span></span>
<span id="cb44-3"><a href="#cb44-3"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SC_1_files/figure-html/cell-32-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="가설검정" class="level3">
<h3 class="anchored" data-anchor-id="가설검정">가설검정</h3>
<section id="상황극" class="level4">
<h4 class="anchored" data-anchor-id="상황극">상황극</h4>
<p><code>-</code> 상황 - 동원참치를 좋아하는 자취생이 있었음. - 그런데 양이 적었음. - 캔의 뒷면을 보니까 중량이 45g이라고 함.</p>
<p><code>-</code> 의심 - 아무리봐도 참치캔의 무게가 45g보다 적은 것 같음.</p>
<p><code>-</code> 문의 - (문의) 참치캔이 45g보다 적다. <span class="math inline">\(\to\)</span> (답변) 참치캔의 무게 <span class="math inline">\(\sim N(45, 1)\)</span> - (생각) 참치캔의 무게는 확률분포라는 것을 따르기 때문에 항상 45g이 아니고 45g보다 작을 수 있다는 논리 - (화남) 그러니까 내가 좀 운이 없는 편인 것이지 우리회사 잘못이 아니란 이야기</p>
<p><code>-</code> 실험 - 아무리 생각해도 미심쩍어서 한 박스(30개가 들어가 있음)를 사서 모두 무게를 재보았다. - 30개 평균무게를 계산하니까 44.50이었다.</p>
<p><code>-</code> 고민 - 실험결과가 44.50g이 나와봤자 확률변수라는 논리로 또 다시 방어가 가능할 듯 하다. - 참치회사에 항의해봤자 “고객님께서 운이 좀 많이 없는 케이스셔요” 라고 둘러댈 것 같다.</p>
</section>
<section id="해결방법" class="level4">
<h4 class="anchored" data-anchor-id="해결방법">해결방법</h4>
<p><code>-</code> 아이디어</p>
<ul>
<li>가만히 생각해보니까 참치캔의 무게가 10g이 나와도 운이 없다고 둘러대면 그만일 것 같다. 참치회사 입장에서는 거의 기적의 논리인 셈.</li>
<li>내가 얼마나 운이 없는 케이스인지 정확한 확률로 계산해보자. <span class="math inline">\(\to\)</span> 참치회사의 주장이 참이라고 가정하자. 그리고 그 세계에서(참치회사의 주장이 참인 세계에서) 나보다 운이 없는 케이스가 14,000,605의 경우의 수 중에서 몇개나 발생했는지 알아보자.</li>
<li>만약에 14,000,605의 경우의 수 중에서 나보다 운이 없는 케이스가 0명이라면? 이건 참치회사가 거짓말을 하고 있다고 생각해도 무방하다.</li>
</ul>
<div id="cell-110" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a>np.random.normal(<span class="dv">45</span>,<span class="dv">1</span>) <span class="co"># 참치캔 하나의 무게</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>45.65559226000502</code></pre>
</div>
</div>
<div id="cell-111" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1"></a>g <span class="op">=</span> np.random.normal(<span class="dv">45</span>,<span class="dv">1</span>,<span class="dv">30</span>) <span class="co"># 참치캔 30개의 무게들</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>array([44.44060247, 44.58578509, 45.18637014, 42.88182346, 43.44174295,
       45.31328539, 44.61031359, 44.35194961, 43.66617982, 44.05899114,
       44.79021104, 46.45200423, 44.9289538 , 44.72000347, 46.99494376,
       44.79112521, 46.8076755 , 44.83231809, 45.64099509, 46.78136459,
       41.87449512, 44.6893391 , 45.36937168, 43.9631011 , 46.32436898,
       44.33644491, 46.91034175, 46.02706234, 43.36750549, 46.23646942])</code></pre>
</div>
</div>
<div id="cell-112" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a>np.mean(g) <span class="co"># 참치캔 30개의 무게의 평균</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>44.94583794428206</code></pre>
</div>
</div>
<div id="cell-113" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1"></a>np.mean(np.array([np.mean(np.random.normal(<span class="dv">45</span>,<span class="dv">1</span>,<span class="dv">30</span>)) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">14000605</span>)]) <span class="op">&lt;</span> <span class="fl">44.50</span>) <span class="co"># p-value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>0.0030819382448115636</code></pre>
</div>
</div>
<p><code>-</code> 자취생의 반론 - 보세요! p-value가 0.05만 되었더라도 내가 운이 매우 나쁜 케이스인가보다 하고 넘어가려고 했어요. 그런데 내가 <span class="math inline">\(p\)</span>-value를 계산했는데 0.003이에요. 이건 너무 낮은 확률입니다. 그래서 저는 당신들이 사기친다고 볼 수 밖에 없어요!</p>
</section>
<section id="이론" class="level4">
<h4 class="anchored" data-anchor-id="이론">이론</h4>
<p><code>-</code> 통계학과 교수님 등장</p>
<ul>
<li>자취생의 말은 이론적으로 옳다.</li>
</ul>
<p>참치회사의 주장을 <span class="math inline">\(H_0\)</span>라고 하고, 학생의 주장을 <span class="math inline">\(H_1\)</span>이라고 하자.</p>
<p><span class="math display">\[H_0:\mu=45\]</span> <span class="math display">\[H_1:\mu&lt;45\]</span></p>
<p>자취생은 <span class="math inline">\(X_i\sim N(\mu,1)\)</span>에서 30개의 샘플을 얻어서 평균을 구했으며 이때 평균값은 <span class="math inline">\(\bar{x}=44.5\)</span>이다. 참치회사의 주장이 맞다는 전제하에서 자취생보다 더 극단적인 <span class="math inline">\(\bar{x}\)</span>를 얻을 확률은 아래와 같다. <span class="math display">\[P(\bar{X}\leq 44.5|H_0 \  \text{is true}) = P(\bar{X}\leq 44.5|\mu=45)\]</span></p>
<p>우변의 식을 정리하면</p>
<p><span class="math display">\[P(\bar{X}\leq 44.5|\mu=45) = P(\frac{\bar{X}-\mu}{\sigma/\sqrt{n}}\leq\frac{44.5-\mu}{\sigma/\sqrt{n}}\bigg|\mu=45)\]</span></p>
<p>우선 <span class="math inline">\(\sigma=1\)</span>이고 참치회사의 주장이 맞다고 전제하였으므로 <span class="math inline">\(\mu=45\)</span>. <span class="math inline">\(n\)</span>은 한 박스에 포함된 참치캔의 수이므로 이 경우는 <span class="math inline">\(n=30\)</span>이다. 따라서 <span class="math inline">\(\frac{44.5-\mu}{\sigma/\sqrt{n}}\approx-2.73861\)</span>이다. 한편 <span class="math inline">\(\frac{\bar{X}-\mu}{\sigma/\sqrt{n}}\sim N(0,1)\)</span> 이므로 (note1의 내용) 구하는 확률 얻기 위해서는 단지 아래만 계산하면 된다.</p>
<p><span class="math display">\[P(Z\leq-2.73861), \ Z\sim N(0,1)\]</span></p>
<p>이 확률은 대략적으로 0.00308 인데 이것은 자취생이 시뮬레이션으로 얻은 0.00306와 거의 비슷하다.</p>
<div id="cell-116" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1"></a>μ<span class="op">=</span><span class="dv">45</span></span>
<span id="cb53-2"><a href="#cb53-2"></a>σ<span class="op">=</span><span class="dv">1</span></span>
<span id="cb53-3"><a href="#cb53-3"></a>n<span class="op">=</span><span class="dv">30</span> </span>
<span id="cb53-4"><a href="#cb53-4"></a>dist <span class="op">=</span> sps.norm(loc<span class="op">=</span><span class="dv">0</span>, scale<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb53-5"><a href="#cb53-5"></a>dist.cdf((<span class="fl">44.5</span><span class="op">-</span>μ)<span class="op">/</span>(σ<span class="op">/</span>np.sqrt(n)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>0.00308494966027208</code></pre>
</div>
</div>
<p>(보충학습)</p>
<div id="cell-118" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1"></a>dist <span class="op">=</span> sps.norm(loc<span class="op">=</span><span class="dv">0</span>, scale<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb55-2"><a href="#cb55-2"></a>dist.cdf(<span class="dv">0</span>) <span class="co">#P(X≤0), where X ~ N(0,1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>0.5</code></pre>
</div>
</div>
<div id="cell-119" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1"></a>dist <span class="op">=</span> sps.norm(loc<span class="op">=</span><span class="dv">0</span>, scale<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb57-2"><a href="#cb57-2"></a>dist.cdf(<span class="fl">1.96</span>) <span class="co">#P(X≤1.96), where X ~ N(0,1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>0.9750021048517795</code></pre>
</div>
</div>
</section>
<section id="차-공방" class="level4">
<h4 class="anchored" data-anchor-id="차-공방">2차 공방</h4>
<p><code>-</code> 이론의 회피 - (참치회사) 이후에 저희가 추가 조사해보니까 참치캔의 분포가 딱 정규분포를 따르진 않더라고요? - (참치회사) 그런데 교수님의 논리전개는 정규분포라는 가정하에 성립하니까 우리의 추가조사 결과에는 적용할 수 없을 것 같다.</p>
<p><code>-</code> 카운터 - 중심극한정리에 의하여 분포상관없이 적당한 <span class="math inline">\(n\)</span>이 보장되기만 한다면 자취생의 시뮬레이션 결과와 교수님의 주장은 여전히 유효하다.</p>
</section>
<section id="숙제" class="level4">
<h4 class="anchored" data-anchor-id="숙제">숙제</h4>
<ul>
<li>자취생의 샘플이 <span class="math inline">\(\bar{x}=44.5\)</span>가 아니라 <span class="math inline">\(\bar{x}=44.8\)</span>이었다고 할 때 p-value를 구해보라.</li>
</ul>
<div id="cell-122" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1"></a>Z <span class="op">=</span> (<span class="fl">44.8</span><span class="op">-</span><span class="dv">45</span>)<span class="op">/</span>(<span class="dv">1</span><span class="op">/</span>np.sqrt(<span class="dv">30</span>))</span>
<span id="cb59-2"><a href="#cb59-2"></a>dist <span class="op">=</span> sps.norm(loc<span class="op">=</span><span class="dv">0</span>, scale<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb59-3"><a href="#cb59-3"></a>dist.cdf(Z) <span class="co"># 0.136</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>0.13666083914614557</code></pre>
</div>
</div>
</section>
</section>
<section id="note3-delta-method-생략" class="level3">
<h3 class="anchored" data-anchor-id="note3-delta-method-생략">note3: delta method (생략)</h3>
</section>
<section id="위치모수와-척도모수" class="level3">
<h3 class="anchored" data-anchor-id="위치모수와-척도모수">위치모수와 척도모수</h3>
<p><code>-</code> 정규분포 특징</p>
<ul>
<li><p>이론: <span class="math inline">\(Z\sim N(0,1) \Rightarrow aZ+b \sim N(b,a^2)\)</span></p></li>
<li><p>생각보다 이거 엄청 신기한 기능이에요</p></li>
<li><p>정규분포에 어떠한 상수를 더해도 정규분포, 어떠한 상수를 곱해도 정규분포, 더하고 곱해도 정규분포!</p></li>
</ul>
<p><code>-</code> 위치모수, 척도모수</p>
<ol type="1">
<li><p>확률변수 <span class="math inline">\(Z\)</span>가 분포 A를 따를 때 <span class="math inline">\(Z+b\)</span>도 분포 A를 따름 <span class="math inline">\(\Rightarrow\)</span> 분포A는 위치모수를 가짐</p></li>
<li><p>확률변수 <span class="math inline">\(Z\)</span>가 분포 B를 따를 때 <span class="math inline">\(aZ\)</span>도 분포 B를 따름 <span class="math inline">\(\Rightarrow\)</span> 분포A는 척도모수를 가짐</p></li>
<li><p>확률변수 <span class="math inline">\(Z\)</span>가 분포 C를 따를 때 <span class="math inline">\(aZ+b\)</span>도 분포 C를 따름 <span class="math inline">\(\Rightarrow\)</span> 분포A는 위치모수와 척도모수를 가짐</p></li>
</ol>
<p><code>-</code> 예시:</p>
<ul>
<li><p>분포C: {{정규분포, 균등분포, 로지스틱, 이중지수, 코쉬}}</p></li>
<li><p>분포A: 분포C와 동일</p></li>
<li><p>분포B: 분포C <span class="math inline">\(\cup\)</span> {{지수분포, 감마분포}}</p></li>
<li><p>분포C - 분포A: 없다고 생각하세요..</p></li>
<li><p>분포C - 분포B: {{지수분포, 감마분포}}</p></li>
</ul>
<p>(예제1)</p>
<p>(예제2)</p>
<p>(예제3)</p>
<p>. . . .</p>
</section>
</section>
<section id="카이제곱분포-xsim-chi2k" class="level2">
<h2 class="anchored" data-anchor-id="카이제곱분포-xsim-chi2k">카이제곱분포: <span class="math inline">\(X\sim \chi^2(k)\)</span></h2>
<section id="motive" class="level3">
<h3 class="anchored" data-anchor-id="motive">motive</h3>
<p>(예제) <span class="math inline">\(X_i\overset{iid}{\sim}N(7,\sigma^2)\)</span>일 때 아래를 test 하고 싶다고 하자 <span class="math display">\[H_0: \sigma^2=4\]</span> <span class="math display">\[H_1: \sigma^2&lt;4\]</span> 30개의 샘플을 확보하여 <span class="math inline">\(\xi=\frac{1}{30}\sum^{30}_{i=1}(x_i-7)^2\)</span>를 계산하였으며 계산결과 <span class="math inline">\(\xi=2.72\)</span>가 나왔다고 하자. <span class="math inline">\(p\)</span>-value를 구하여라.</p>
<p>(풀이1)</p>
<div id="cell-129" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1"></a>xis <span class="op">=</span> [np.mean((np.random.normal(<span class="dv">7</span>,<span class="dv">2</span>,<span class="dv">30</span>)<span class="op">-</span><span class="dv">7</span>)<span class="op">**</span><span class="dv">2</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">14000605</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-130" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1"></a>np.mean(np.array(xis)<span class="op">&lt;</span><span class="fl">2.72</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>0.09435406541360176</code></pre>
</div>
</div>
<ul>
<li>생각보다 나올법한 확률이다.</li>
</ul>
<p><code>-</code> 분산이 4가 아닌 것 같다라고 주장하기 위해서는 (95%)</p>
<div id="cell-133" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1"></a>np.quantile(xis, <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>2.4653042700709666</code></pre>
</div>
</div>
<ul>
<li>2.46보다 같거나 작아야한다.</li>
</ul>
<p>(풀이2)</p>
<p><span class="math inline">\(\xi = \frac{1}{30}\sum^{30}_{i=1}(x_i-7)^2\)</span>는 어떠한 분포A에서 발생한 샘플이라고 볼 수 있다. 그 A의 분포를 이론적으로 잡아보자.</p>
<ul>
<li><p>이론: <span class="math inline">\(\sum^n_{i=1}Z_i^2\sim\chi^2(n)\)</span>, where <span class="math inline">\(Z_i\overset{iid}{\sim}N(0,1).\)</span> 이러한 이론이 있다.</p></li>
<li><p>관찰: 우리예제의 경우에는 <span class="math inline">\(H_0\)</span>가 참이라는 가정하에 <span class="math inline">\(\sum^{30}_{i=1}(\frac{X_i-7}{2})^2\sim\chi^2(30)\)</span></p></li>
<li><p>주장: <span class="math inline">\(\xi\times\frac{30}{4}=\sum^{30}_{i=1}(x_i-7)^2\)</span>는 <span class="math inline">\(\chi^2(30)\)</span>에서 뽑힌 샘플이다.</p></li>
</ul>
<div id="cell-136" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1"></a>xi <span class="op">=</span> <span class="fl">2.72</span></span>
<span id="cb66-2"><a href="#cb66-2"></a></span>
<span id="cb66-3"><a href="#cb66-3"></a>xi<span class="op">*</span><span class="dv">30</span><span class="op">/</span><span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>20.400000000000002</code></pre>
</div>
</div>
<div id="cell-137" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1"></a>dist <span class="op">=</span> sps.chi2(<span class="dv">30</span>)</span>
<span id="cb68-2"><a href="#cb68-2"></a>dist.cdf(xi<span class="op">*</span><span class="dv">30</span><span class="op">/</span><span class="dv">4</span>) <span class="co"># 시뮬레이션 값과 비슷</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>0.09429163377738799</code></pre>
</div>
</div>
<p><code>-</code> 분산이 4는 아닌 것 같다라고 주장하려면? (95%)</p>
<div id="cell-139" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1"></a>dist.ppf(<span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>18.492660981953467</code></pre>
</div>
</div>
<p><span class="math inline">\(\xi \times 30/4 = 18.492660981953467\)</span>라는 말이니까</p>
<div id="cell-141" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1"></a>dist.ppf(<span class="fl">0.05</span>) <span class="op">/</span> <span class="dv">30</span> <span class="op">*</span> <span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>2.465688130927129</code></pre>
</div>
</div>
<ul>
<li>2.46보다 같거나 작아야한다. (위와 동일)</li>
</ul>
</section>
<section id="카이제곱-분포-요약" class="level3">
<h3 class="anchored" data-anchor-id="카이제곱-분포-요약">카이제곱 분포 요약</h3>
<ul>
<li>X의 의미: 서로 독립인 표준정규분포의 제곱합</li>
<li>X의 범위: <span class="math inline">\(x\in (0,\infty)\)</span></li>
<li>파라메터의 의미: <span class="math inline">\(k\)</span>는 자유도, 표준정규분포 제곱을 몇개 합쳤는지…</li>
<li>파라메터의 범위: <span class="math inline">\(k=1,2,3,4,\dots\)</span></li>
<li>pdf:</li>
<li>mgf:</li>
<li>E(X): <span class="math inline">\(k\)</span></li>
<li>V(X): <span class="math inline">\(2k\)</span></li>
</ul>
</section>
<section id="대의적-정의" class="level3">
<h3 class="anchored" data-anchor-id="대의적-정의">대의적 정의</h3>
<ul>
<li><span class="math inline">\(X\sim\chi^2(k)\Leftrightarrow X \overset{d}{=} Z_1^2+\dots+Z^2_k\)</span>, where <span class="math inline">\(Z_i\overset{iid}{\sim}N(0,1)\)</span></li>
</ul>
</section>
<section id="how-to-generate-it-3" class="level3">
<h3 class="anchored" data-anchor-id="how-to-generate-it-3">How to generate it?</h3>
<section id="자유도가-4인-카이제곱분포에서-100개의-샘플을-얻는-방법" class="level4">
<h4 class="anchored" data-anchor-id="자유도가-4인-카이제곱분포에서-100개의-샘플을-얻는-방법">자유도가 4인 카이제곱분포에서 100개의 샘플을 얻는 방법</h4>
<p>(방법1)</p>
<div id="cell-146" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1"></a>np.random.chisquare(<span class="dv">4</span>, <span class="dv">100</span>)[:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>array([4.23661203, 2.77348336, 5.43154643, 1.84772286, 2.23430818])</code></pre>
</div>
</div>
<p>(방법2) 정규분포 <span class="math inline">\(\rightarrow\)</span> 카이제곱분포</p>
<div id="cell-148" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1"></a>[np.<span class="bu">sum</span>(np.random.normal(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">4</span>)<span class="op">**</span><span class="dv">2</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>)][:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>[0.9470195437591595,
 3.1040636594475677,
 2.2264229504547757,
 5.070560026199548,
 5.5961173298844225]</code></pre>
</div>
</div>
<p>(방법3) 지수분포 <span class="math inline">\(\rightarrow\)</span> 카이제곱분포</p>
<ul>
<li><p>복습: <span class="math inline">\(X, Y \overset{iid}{\sim} N(0,1) \Rightarrow R^2/2 \sim Exp(1)\)</span>, where <span class="math inline">\(R^2 = X^2+Y^2\)</span></p></li>
<li><p>즉, <span class="math inline">\(2 \times \frac{R^2}{2} + 2 \times \frac{R^2}{2} = Z_1^2 + Z_2^2 + Z_3^2 + Z_4^2 \sim \chi^2(4)\)</span></p></li>
</ul>
<div id="cell-150" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1"></a>[np.random.exponential(<span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span> <span class="op">+</span> np.random.exponential(<span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>)][:<span class="dv">5</span>]</span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="co">#표준정규분포를 4개 더한 것</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>[1.8829768607694999,
 0.9336651649834132,
 5.965820376025277,
 0.8428830673590306,
 8.645433131925193]</code></pre>
</div>
</div>
<div id="cell-151" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1"></a>[np.random.exponential(<span class="dv">2</span>)<span class="op">+</span>np.random.exponential(<span class="dv">2</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>)][:<span class="dv">5</span>]</span>
<span id="cb80-2"><a href="#cb80-2"></a><span class="co">#지수분포는 scale parameter를 가지기 때문에.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>[0.8591426263189498,
 5.769427223696833,
 7.027424120087312,
 4.539451879434549,
 4.229829641106975]</code></pre>
</div>
</div>
<div id="cell-152" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1"></a>N<span class="op">=</span><span class="dv">10000</span></span>
<span id="cb82-2"><a href="#cb82-2"></a>X1 <span class="op">=</span> np.random.chisquare(<span class="dv">4</span>, N)</span>
<span id="cb82-3"><a href="#cb82-3"></a>X2 <span class="op">=</span> [np.<span class="bu">sum</span>(np.random.normal(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">4</span>)<span class="op">**</span><span class="dv">2</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N)]</span>
<span id="cb82-4"><a href="#cb82-4"></a>X3 <span class="op">=</span> [np.random.exponential(<span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span> <span class="op">+</span> np.random.exponential(<span class="dv">1</span>)<span class="op">*</span><span class="dv">2</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N)]</span>
<span id="cb82-5"><a href="#cb82-5"></a>X4 <span class="op">=</span> [np.random.exponential(<span class="dv">2</span>) <span class="op">+</span> np.random.exponential(<span class="dv">2</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N)]</span>
<span id="cb82-6"><a href="#cb82-6"></a></span>
<span id="cb82-7"><a href="#cb82-7"></a>fig, ((ax1,ax2), (ax3,ax4)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">8</span>))</span>
<span id="cb82-8"><a href="#cb82-8"></a></span>
<span id="cb82-9"><a href="#cb82-9"></a>ax1.hist(X1, label<span class="op">=</span><span class="st">'X1'</span>, bins<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb82-10"><a href="#cb82-10"></a>ax2.hist(X2, label<span class="op">=</span><span class="st">'X2'</span>, bins<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb82-11"><a href="#cb82-11"></a>ax3.hist(X3, label<span class="op">=</span><span class="st">'X3'</span>, bins<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb82-12"><a href="#cb82-12"></a>ax4.hist(X4, label<span class="op">=</span><span class="st">'X4'</span>, bins<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb82-13"><a href="#cb82-13"></a></span>
<span id="cb82-14"><a href="#cb82-14"></a>ax1.legend()<span class="op">;</span> ax2.legend()<span class="op">;</span> ax3.legend()<span class="op">;</span> ax4.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SC_1_files/figure-html/cell-52-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>-</code> 정리하면 아래와 같이 된다.</p>
<ul>
<li><p><span class="math inline">\(Y \sim \chi^2(4)\)</span></p></li>
<li><p><span class="math inline">\(Y \overset{d}{=}Z_1^2+Z_2^2+Z_3^2+Z_4^2\)</span>, where <span class="math inline">\(Z_i\overset{iid}{\sim}N(0,1)\)</span></p></li>
<li><p><span class="math inline">\(Y \overset{d}{=}2\frac{Z_1^2+Z_2^2}{2}+2\frac{Z_3^2+Z_4^2}{2}\)</span>, where <span class="math inline">\(R^2_i/2\overset{iid}{\sim}Exp(1)\)</span></p></li>
<li><p><span class="math inline">\(Y \overset{d}{=} X_1 + X_2\)</span>, where <span class="math inline">\(X_1, X_2 \overset{iid}{\sim}Exp(2)\)</span> 마지막은 척도모수와 관련된..?</p></li>
</ul>
<p><code>-</code> 자유도가 6인 카이제곱분포 - 표준정규분포 6개를 제곱하여 합친것과 같다. - 평균이 2인 지수분포 3개를 합친것과 같다.</p>
<p><code>-</code> 자유도가 k인 카이제곱분포 - 표준정규분포 k개를 제곱하여 합친것과 같다. - 평균이 2인 지수분포 k/2개를 합친것과 같다. (?) <span class="math inline">\(\to\)</span> 감마분포의 모티브</p>
</section>
</section>
<section id="note-표본분산의-분포" class="level3">
<h3 class="anchored" data-anchor-id="note-표본분산의-분포">note: 표본분산의 분포</h3>
<ul>
<li>이론: <span class="math inline">\(X_1,\dots,X_n\overset{iid}{\sim}N(0,1) \Rightarrow \frac{(n-1)S^2}{\sigma^2}\sim \chi^2(n-1)\)</span></li>
<li>나중에 다시 다룸..</li>
</ul>
</section>
<section id="카이제곱-분포의-합" class="level3">
<h3 class="anchored" data-anchor-id="카이제곱-분포의-합">카이제곱 분포의 합</h3>
<ul>
<li>이론: $X^2(k_1), Y^2(k_2), XY X+Y ^2(k_1+k_2) $</li>
</ul>
</section>
<section id="히스토그램" class="level3">
<h3 class="anchored" data-anchor-id="히스토그램">히스토그램</h3>
<ul>
<li><p>자유도가 2인 카이제곱 = 평균이 2인 지수분포</p></li>
<li><p>카이제곱은 자유도가 커질수록 대칭이 되어간다.</p></li>
<li><p>중심의 위치는 자유도의 값과 비슷</p></li>
</ul>
</section>
</section>
<section id="감마분포-xsimgammaalpha-beta" class="level2">
<h2 class="anchored" data-anchor-id="감마분포-xsimgammaalpha-beta">감마분포: <span class="math inline">\(X\sim\Gamma(\alpha, \beta)\)</span></h2>
<section id="감마분포-요약" class="level3">
<h3 class="anchored" data-anchor-id="감마분포-요약">감마분포 요약</h3>
<ul>
<li><p>X의 의미: 서로 독립인 지수분포를 <span class="math inline">\(\alpha\)</span>개 합친 것, 시간 1에 평균적으로 <span class="math inline">\(\lambda\)</span>번 발생하는 사건이 있을 때 <span class="math inline">\(\alpha\)</span>번째 사건이 발생할 때까지 걸리는 시간</p></li>
<li><p>X의 범위: <span class="math inline">\(x\in(0,\infty)\)</span></p></li>
<li><p>파라메터의 의미: <span class="math inline">\(\alpha=\)</span>지수분포를 더한 횟수(의 확장버전), <span class="math inline">\(\beta=\frac{1}{\lambda}=\)</span>지수분포의 평균</p></li>
<li><p>파라메터의 범위: <span class="math inline">\(\alpha&gt;0, \beta&gt;0\)</span></p></li>
<li><p>pdf: <span class="math inline">\(\frac{1}{\Gamma(\alpha)\beta^\alpha}x^{\alpha-1}e^{-x/\beta}\)</span></p></li>
<li><p>mgf:</p></li>
<li><p>E(X): <span class="math inline">\(\alpha\beta\)</span></p></li>
<li><p>V(X): <span class="math inline">\(\alpha\beta^2\)</span></p></li>
</ul>
</section>
<section id="대의적-정의alpha가-자연수일-경우" class="level3">
<h3 class="anchored" data-anchor-id="대의적-정의alpha가-자연수일-경우">대의적 정의(<span class="math inline">\(\alpha\)</span>가 자연수일 경우)</h3>
<ul>
<li><p><span class="math inline">\(X\sim\Gamma(\alpha,\beta)\overset{d}{\Leftrightarrow}Z_1+\dots+Z_\alpha\)</span>, where <span class="math inline">\(Z_i\overset{iid}{\sim}Exp(\frac{1}{\beta})\)</span></p></li>
<li><p><span class="math inline">\(Exp(\frac{1}{\beta})\)</span>는 평균이 <span class="math inline">\(\beta\)</span>인 지수분포</p></li>
</ul>
</section>
<section id="how-to-generate-it-4" class="level3">
<h3 class="anchored" data-anchor-id="how-to-generate-it-4">how to generate it?</h3>
<section id="gamma32를-1000개-생성하라." class="level4">
<h4 class="anchored" data-anchor-id="gamma32를-1000개-생성하라."><span class="math inline">\(\Gamma(3,2)\)</span>를 1000개 생성하라.</h4>
<div id="cell-162" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1"></a>a<span class="op">=</span><span class="dv">3</span></span>
<span id="cb83-2"><a href="#cb83-2"></a>b<span class="op">=</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(방법1)</p>
<div id="cell-164" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1"></a>np.random.gamma(a, b, <span class="dv">1000</span>)[:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>array([ 9.71933815,  7.99068886,  7.56259455, 14.96478038,  7.9842099 ])</code></pre>
</div>
</div>
<p>(방법2) 지수분포 → 감마분포</p>
<div id="cell-166" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1"></a>[np.<span class="bu">sum</span>(np.random.exponential(b, a)) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1000</span>)][:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>[2.206747933276282,
 10.457792034901699,
 11.763758964906064,
 9.883464276208098,
 8.29207809727784]</code></pre>
</div>
</div>
<p>(방법3) 표준정규분포 이용</p>
<div id="cell-168" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1"></a>[np.<span class="bu">sum</span>(np.random.normal(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span><span class="op">*</span>a)<span class="op">**</span><span class="dv">2</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1000</span>)][:<span class="dv">5</span>]</span>
<span id="cb88-2"><a href="#cb88-2"></a><span class="co"># 방법3이 가능한 이유는 2a가 현재 자연수이고, b=2 이기 때문.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>[1.534278807696258,
 3.106678006479342,
 4.081251489899774,
 15.071812425431794,
 6.94872725696303]</code></pre>
</div>
</div>
<p>(방법4) 카이제곱분포 이용</p>
<div id="cell-170" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1"></a>np.random.chisquare(<span class="dv">2</span><span class="op">*</span>a, <span class="dv">1000</span>)[:<span class="dv">5</span>]</span>
<span id="cb90-2"><a href="#cb90-2"></a><span class="co"># 방법4가 가능한 이유는 2a가 현재 자연수이고, b=2 이기 때문.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>array([ 2.7665365 , 10.11844372,  3.20742109,  4.76564108, 10.56994416])</code></pre>
</div>
</div>
<p><code>-</code> 확인</p>
<div id="cell-172" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1"></a>N<span class="op">=</span><span class="dv">10000</span></span>
<span id="cb92-2"><a href="#cb92-2"></a>fig, ((ax1, ax2), (ax3, ax4)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb92-3"><a href="#cb92-3"></a>ax1.hist(np.random.gamma(a, b, N), label <span class="op">=</span> <span class="st">'X1'</span>)</span>
<span id="cb92-4"><a href="#cb92-4"></a>ax2.hist([np.<span class="bu">sum</span>(np.random.exponential(b, a)) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N)], label <span class="op">=</span> <span class="st">'X2'</span>, color<span class="op">=</span><span class="st">'C1'</span>)</span>
<span id="cb92-5"><a href="#cb92-5"></a>ax3.hist([np.<span class="bu">sum</span>(np.random.normal(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span><span class="op">*</span>a)<span class="op">**</span><span class="dv">2</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N)], label <span class="op">=</span> <span class="st">'X3'</span>, color<span class="op">=</span><span class="st">'C2'</span>)</span>
<span id="cb92-6"><a href="#cb92-6"></a>ax4.hist(np.random.chisquare(<span class="dv">2</span><span class="op">*</span>a, N), label <span class="op">=</span> <span class="st">'X4'</span>, color<span class="op">=</span><span class="st">'C3'</span>)</span>
<span id="cb92-7"><a href="#cb92-7"></a></span>
<span id="cb92-8"><a href="#cb92-8"></a>ax1.legend()<span class="op">;</span> ax2.legend()<span class="op">;</span> ax3.legend()<span class="op">;</span> ax4.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SC_1_files/figure-html/cell-58-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="감마분포와-카이제곱분포의-관계" class="level3">
<h3 class="anchored" data-anchor-id="감마분포와-카이제곱분포의-관계">감마분포와 카이제곱분포의 관계</h3>
<p><code>-</code> 이론: <span class="math inline">\(X\overset{d}{=}Y,\)</span> where <span class="math inline">\(X\sim\chi^2(k)\)</span> and <span class="math inline">\(Y\sim\Gamma(\frac{k}{2},2).\)</span></p>
<div id="cell-174" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1"></a>k<span class="op">=</span><span class="dv">3</span></span>
<span id="cb93-2"><a href="#cb93-2"></a></span>
<span id="cb93-3"><a href="#cb93-3"></a>fig, ((ax1), (ax2)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb93-4"><a href="#cb93-4"></a>ax1.hist(np.random.chisquare(k, <span class="dv">10000</span>), bins<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb93-5"><a href="#cb93-5"></a>ax2.hist(np.random.gamma(k<span class="op">/</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">10000</span>), bins<span class="op">=</span><span class="dv">50</span>, color<span class="op">=</span><span class="st">'C1'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SC_1_files/figure-html/cell-59-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="척도모수" class="level3">
<h3 class="anchored" data-anchor-id="척도모수">척도모수</h3>
<p><code>-</code> 감마분포도 척도모수를 가짐</p>
<ul>
<li>감마분포의 곱셈을 해도 감마분포가 된다</li>
</ul>
<div id="cell-177" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1"></a>fig, ((ax1, ax2)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb94-2"><a href="#cb94-2"></a></span>
<span id="cb94-3"><a href="#cb94-3"></a>ax1.hist(np.random.gamma(<span class="dv">50</span>,<span class="dv">6</span>, <span class="dv">100000</span>), bins<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb94-4"><a href="#cb94-4"></a>ax2.hist(np.random.gamma(<span class="dv">50</span>,<span class="dv">2</span>, <span class="dv">100000</span>)<span class="op">*</span><span class="dv">3</span>, bins<span class="op">=</span><span class="dv">50</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SC_1_files/figure-html/cell-60-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="감마분포의-합" class="level3">
<h3 class="anchored" data-anchor-id="감마분포의-합">감마분포의 합</h3>
<p><code>-</code> 이론: <span class="math inline">\(X\sim\Gamma(\alpha_1,\beta), Y\sim \Gamma(\alpha_2, \beta), \ \  X\bot Y \Rightarrow X+Y\sim \Gamma(\alpha_1 + \alpha_2, \beta)\)</span></p>
<div id="cell-180" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1"></a>fig, ((ax1, ax2)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb95-2"><a href="#cb95-2"></a></span>
<span id="cb95-3"><a href="#cb95-3"></a>ax1.hist(np.random.gamma(<span class="dv">25</span>,<span class="dv">6</span>, <span class="dv">10000</span>), bins<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb95-4"><a href="#cb95-4"></a>ax2.hist(np.random.gamma(<span class="dv">6</span>,<span class="dv">6</span>, <span class="dv">10000</span>)<span class="op">+</span>np.random.gamma(<span class="dv">25</span><span class="op">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">10000</span>), bins<span class="op">=</span><span class="dv">50</span>, color<span class="op">=</span><span class="st">'C1'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SC_1_files/figure-html/cell-61-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="지수분포의-다양한-표현" class="level2">
<h2 class="anchored" data-anchor-id="지수분포의-다양한-표현">지수분포의 다양한 표현</h2>
<p><code>-</code> 지수분포는 다양하게 표현된다.</p>
<ul>
<li><p>경우1: <span class="math inline">\(X\sim Exp(\theta), f(x)=\frac{1}{\theta}e^{-\frac{x}{\theta}}\)</span></p></li>
<li><p>경우2: <span class="math inline">\(X\sim Exp(1/\lambda), f(x)=\lambda e^{-\lambda x}\)</span></p></li>
<li><p>경우3: <span class="math inline">\(X\sim Exp(\lambda), f(x)=\lambda e^{-\lambda x}\)</span></p></li>
</ul>
<p><code>-</code> 기억할 것</p>
<ul>
<li><p>경우1: 지수분포의 모수는 평균, 지수분포의 파라메터는 <span class="math inline">\(\theta = \frac{1}{\lambda}\)</span> 으로 정의하여 새롭게 사용</p></li>
<li><p>경우2: 지수분포의 모수는 평균, 지수분포의 파라메터는 포아송의 <span class="math inline">\(\lambda\)</span> 를 재활용</p></li>
<li><p>경우3: 지수분포의 모수는 평균의 역수, 지수분포의 파라메터는 포아송의 <span class="math inline">\(\lambda\)</span> 를 재활용.</p></li>
</ul>
<p><code>-</code> 노테이션의 숨은 의도들 (교수님 생각)</p>
<ul>
<li><p>경우2: 포아송분포의 파라메터도 그대로 쓰고 싶고, “지수분포의 모수 = 지수분포의 평균”과 같이 만들고 싶음</p></li>
<li><p>경우1: 경우2에서는 <span class="math inline">\(X\sim Exp(1/\lambda)\)</span> 로 표현되어서 모수가 역수로 되어있어 헷갈림. 그냥 포아송분포의 <span class="math inline">\(\lambda\)</span> 를 버리는 편이 좋겠음. 지수분포의 평균을 의미하는 <span class="math inline">\(\theta\)</span> 를 새롭게 정의하고 이 <span class="math inline">\(\theta\)</span> 를 중심으로 pdf를 만듦</p></li>
<li><p>경우3: 경우2에서는 <span class="math inline">\(X\sim Exp(1/\lambda)\)</span> 로 표현되어서 모수가 역수로 되어있어 헷갈림. 그냥 모수는 그대로 <span class="math inline">\(Exp(\lambda)\)</span> 를 쓰고 지수분포의 평균을 모수의 역수로 정의하는 것이 좋겠음.</p></li>
</ul>
<p><code>-</code> 아무튼 여러가지 방식으로 표현합니다.</p>
<ul>
<li><p>경우1: 줄리아, 파이썬, 위키</p></li>
<li><p>경우2: 교수님께서 공부한 교재. 요즘은 이렇게 잘 안쓰는 것 같음</p></li>
<li><p>경우3: R, 위키</p></li>
</ul>
<p><code>-</code> 교수님께서는 평균이 314인 지수분포의 pdf는 <span class="math inline">\(f(x) = \frac{1}{314} e^{-x/314}\)</span> 이다 ← 이렇게 외우셨다고 함</p>
<section id="숙제-1" class="level4">
<h4 class="anchored" data-anchor-id="숙제-1">숙제</h4>
<p><code>-</code> 평균이 2인 지수분포를 이용하여 자유도가 20인 카이제곱분포를 생성하여라</p>
<ul>
<li><p><span class="math inline">\(\Gamma (\frac{\alpha}{2}, 2) = \chi^2(\alpha)\)</span> 이므로 <span class="math inline">\(\alpha\)</span>에 20을 대입하면 <span class="math inline">\(\Gamma (10, 2) = \chi^2(20)\)</span></p>
<p>따라서 평균이 2인 지수분포 10개의 합이다.</p></li>
</ul>
<div id="cell-185" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1"></a>ax1, ((ax1), (ax2)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb96-2"><a href="#cb96-2"></a></span>
<span id="cb96-3"><a href="#cb96-3"></a>ax1.hist([np.<span class="bu">sum</span>(np.random.exponential(<span class="dv">2</span>, <span class="dv">10</span>)) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10000</span>)], bins<span class="op">=</span><span class="dv">50</span>)</span>
<span id="cb96-4"><a href="#cb96-4"></a>ax2.hist(np.random.chisquare(<span class="dv">20</span>, <span class="dv">10000</span>), bins<span class="op">=</span><span class="dv">50</span>, color<span class="op">=</span><span class="st">'C1'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="SC_1_files/figure-html/cell-62-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="참고-검정의-형식-논리" class="level2">
<h2 class="anchored" data-anchor-id="참고-검정의-형식-논리">참고: 검정의 형식 논리</h2>
<p><code>-</code> 검정을 진행하는 방법은 아래와 같다.</p>
<ul>
<li>기: 누군가가 (혹은 세상이) <span class="math inline">\(H_0\)</span>가 참이라고 주장한다. 나는 <span class="math inline">\(H_1\)</span>이 참인 것 같다.</li>
<li>승: 누군가와 (혹은 세상과) 싸우기 위하여 샘플을 수집하고 검정통계량을 구한다.</li>
<li>전: 검정통계량의 분포를 잡아내서 <span class="math inline">\(p\)</span>-value를 계산한다. 이 <span class="math inline">\(p\)</span>-value는 “니가 틀렸겠지”라는 주장에 대한 카운터.</li>
<li>결: <span class="math inline">\(H_0\)</span>가 참일지 <span class="math inline">\(H_1\)</span>이 참일지 판단. 절대적인 기준은 없음. (하지만 굉장히 보수적인 사람이라도 <span class="math inline">\(p\)</span>-value가 0.05보다 작으면 <span class="math inline">\(H_1\)</span>이 참이라고 인정)</li>
</ul>
<p><code>-</code> 포인트는 검정통계량의 분포를 잡아내는 것인데, <span class="math inline">\(H_0\)</span>가 참이라는 전제하에 시뮬레이팅 해도 되고 이론적인 분포를 손으로 유도해도 된다.</p>
<ul>
<li>당연히 컴퓨터가 없던 시절에는 시뮬레이팅이 불가능했으므로 “이론적으로 유도 + 통계표(?)”를 이용해서 <span class="math inline">\(p\)</span>-value를 계산해야 했다.</li>
</ul>
<p><code>-</code> 다양한 분포를 공부하는 이유? 검정통계량의 이론적 분포를 잡아내기 위해서!+ <span class="math inline">\(\alpha\)</span></p>
<ul>
<li>카이제곱분포를 왜 공부해야? 정규분포를 따르는 샘플의 분산을 test하기 위해서! + <span class="math inline">\(\alpha\)</span></li>
</ul>
<hr>
<p><code>!</code> p-value 관련하여 내가 정리해보기.</p>
<ul>
<li><p>귀무가설 H0: 연구자가 테스트하고자 하는 가설을 부정하는 가설. 무작위로 발생한 것이라고 가정</p></li>
<li><p>대립가설 H1: 귀무가설을 기각하고자 하는 가설. 보통은 연구자의 주장이나 가설</p></li>
<li><p>p-value는 <strong>귀무가설이 사실일 확률</strong>을 나타낸다. 그 값이 낮을수록 귀무가설을 기각하는 경향이 강해진다. 보통은 특정 유의수준(<span class="math inline">\(\alpha\)</span>)보다 작은 p-value를 가지면 귀무가설을 기각한다. 유의수준은 0.05나 0.01이 많이 사용된다.</p></li>
<li><p>예를 들어, 우연히 어떠한 값이 나왔을 때 이 값과 같거나 더 <strong>극단적인 값이 나올 확률</strong>이 p-value이다. 예를들어 p-value가 0.04이 나왔다고 했을 때 이 값은 가정한 분포에서 우연히 나올 확률이 4%라는 것이고, 랜덤으로 이러한 극단적인 값이 나올 확률이 매우 낮으므로 통계적으로 유의하다고 볼 수 있다.(유의수준을 0.05(5%)로 설정한 경우에. 만약 유의수준을 0.01로 설정하였다면 이 값은 유의하지 않다.)</p></li>
</ul>
<p><code>!</code> 검정의 종류와 목적 관련하여 내가 정리해보기.</p>
<ol type="1">
<li>t-test: <strong>평균값의 차이</strong>를 비교하는 데 사용.(보통 <strong>2개</strong>의 그룹 비교) 모집단의 분포가 정규분포를 따르고 등분산성을 만족할 때 사용된다.</li>
<li>카이제곱<span class="math inline">\(\chi^2\)</span> 검정: <strong>정규분포를 따르는 샘플의 등분산성</strong>을 검정 / 범주형 변수 간의 관계를 검정하는 데 사용(관측된 빈도가 기대 빈도와 유의하게 다른지/두 변수가 독립적인지)</li>
<li>회귀분석: 변수간의 관계를 검증. 종속변수(Y)와 하나이상의 독립변수(X)간의 관계를 모델링하고 예측</li>
<li>상관분석: 두 변수 간의 관계의 강도와 방향을 확인하는 데 사용</li>
</ol>
<ul>
<li>ANOVA (Analysis of Variance): <strong>평균값을 비교</strong>하는 데 사용(<strong>3개 이상</strong>의 그룹 비교) 일반적으로 F-통계량을 사용</li>
<li>비모수 검정: 데이터가 정규분포를 따르지 않거나 등분산성을 만족하지 않을 때 사용</li>
<li>생존분석: 사건이 발생하는 시간을 분석하는 데 사용. 생존 시간이나 사건 발생률을 비교하여 그룹 간의 차이를 확인</li>
</ul>
</section>
<section id="분포-간의-관계식-총정리" class="level2">
<h2 class="anchored" data-anchor-id="분포-간의-관계식-총정리">분포 간의 관계식 총정리</h2>
<p>…</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>